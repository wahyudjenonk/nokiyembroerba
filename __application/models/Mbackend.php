<?php if (!defined('BASEPATH')) {exit('No direct script access allowed');}class Mbackend extends CI_Model{	function __construct(){		parent::__construct();		//$this->auth = unserialize(base64_decode($this->session->userdata('n0k111a')));	}		function getdata($type="", $balikan="", $p1="", $p2="",$p3="",$p4=""){		$where = " WHERE 1=1 ";		if($this->input->post('kat')){			if($this->input->post('kat') == 'all'){				$table = $this->input->post('table');				$field = $this->db->list_fields($table);				$where .= " AND ( ";				foreach($field as $k => $v){					if($v == 'update_by' || $v == 'update_date'){						continue;					}					if ($k == reset($field)){						$where .= " A.".$v." like '%".$this->db->escape_str($this->input->post('key'))."%' ";					}elseif ($k == end($field)){						$where .= " A.".$v." like '%".$this->db->escape_str($this->input->post('key'))."%' ";					}else{						$where .= "OR A.".$v." like '%".$this->db->escape_str($this->input->post('key'))."%' ";					}				}				$where .= " ) ";			}else{				$where .=" AND A.".$this->input->post('kat')." like '%".$this->db->escape_str($this->input->post('key'))."%'";			}		}		if($this->input->post('allfield')){			$table = $this->input->post('table');			$field = $this->db->list_fields($table);			$where .= " AND ( ";			foreach($field as $k => $v){				if($v == 'update_by' || $v == 'update_date'){						continue;				}				if ($k == reset($field)){					$where .= " A.".$v." like '%".$this->db->escape_str($this->input->post('allfield'))."%' ";				}elseif ($k == end($field)){						$where .= " A.".$v." like '%".$this->db->escape_str($this->input->post('allfield'))."%' ";				}else{					$where .= "OR A.".$v." like '%".$this->db->escape_str($this->input->post('allfield'))."%' ";				}			}			$where .= " ) ";		}				if($this->input->post('phaseyear')){			$where .= "				AND ".$this->input->post('initial_phase').".phase_year like '%".$this->input->post('phaseyear')."%' 			";		}		if($this->input->post('phasename')){			$where .= "				AND ".$this->input->post('initial_phase').".phase_name like '%".$this->input->post('phasename')."%' 			";		}		if($this->input->post('boqno')){			$where .= "				AND ".$this->input->post('initial_boqno').".boqno like '%".$this->input->post('boqno')."%' 			";		}			if($this->input->post('potype')){			$where .= "				AND ".$this->input->post('initial_potype').".po_type like '%".$this->input->post('potype')."%' 			";		}			if($this->input->post('regioncode')){			$where .= "				AND ".$this->input->post('initial_regioncode').".region_code like '%".$this->input->post('regioncode')."%' 			";		}			if($this->input->post('siteid')){			$where .= "				AND ".$this->input->post('initial_site').".site_id like '%".$this->input->post('siteid')."%' 			";		}		if($this->input->post('sitename')){			$where .= "				AND ".$this->input->post('initial_site').".site_name like '%".$this->input->post('sitename')."%' 			";		}		if($this->input->post('crtype')){			$where .= "				AND A.cr_type like '%".$this->input->post('crtype')."%' 			";		}			if($this->input->post('crstatus')){			$where .= "				AND A.cr_status like '%".$this->input->post('crstatus')."%' 			";		}				if($this->input->post('username_search')){			$where .= "				AND A.nama_user like '%".$this->input->post('username_search')."%' 			";		}				if($this->input->post('grouplist')){			$where .= "				AND A.group_user like '%".$this->input->post('grouplist')."%' 			";		}				switch($type){			case "data_login":				$sql = "					SELECT *					FROM tbl_user 					WHERE nama_user = '".$p1."'				";			break;			case "phase": 				$sql = "					SELECT A.*					FROM tbl_master_phase A					$where 				";							break;			case "potype": 				$sql = "					SELECT A.*					FROM tbl_master_potype A					$where				";			break;			case "pocurrency": 				$sql = "					SELECT A.*					FROM tbl_master_pocurrency A					$where				";			break;			case "region": 				$sql = "					SELECT A.*					FROM tbl_master_region A					$where				";			break;			case "sitename": 				$sql = "					SELECT A.*					FROM tbl_master_sitename A					$where				";			break;			case "pone": 				$sql = "					SELECT A.*					FROM tbl_master_pone A					$where				";			break;			case "masterpo": 				$sql = "					SELECT A.*, B.phase_code, B.phase_name, B.phase_year,						D.currency, C.po_type					FROM tbl_master_po A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id					LEFT JOIN tbl_master_potype C ON C.id = A.tbl_master_potype_id					LEFT JOIN tbl_master_pocurrency D ON D.id = A.tbl_master_currency_id					$where ORDER BY po_no ASC				";				//echo $sql; exit;			break;			case "mastercr": 				$sql = "					SELECT A.*, B.phase_code, B.phase_name, B.phase_year					FROM tbl_master_cr A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id					$where				";			break;			case "uploadtracker":				$sql = "					SELECT A.*					FROM tbl_uploader_tracker A				";			break;			case "siteinfo":				$sql = "					SELECT A.*, B.phase_code, B.phase_name,						C.site_status, D.region_code, E.po_ne, F.id as uploader_id					FROM tbl_master_tracker_siteinfo A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id 					LEFT JOIN tbl_master_sitename C ON C.id = A.tbl_master_sitename_id					LEFT JOIN tbl_master_region D ON D.id = A.tbl_master_region_id					LEFT JOIN tbl_master_pone E ON E.id = A.tbl_master_pone_id					LEFT JOIN tbl_uploader_tracker F ON F.file_name = A.file_name					$where				";			break;			case "siteprogress":				$sql = "					SELECT A.*, 						B.site_id, B.site_name, B.sow_category, B.partner_ni,						C.site_status, D.region_code, E.po_ne, F.id as uploader_id,						G.phase_name					FROM tbl_master_tracker_siteprogress A					LEFT JOIN tbl_master_tracker_siteinfo B ON B.boqno /*siteinfo*/ = A.boqno					LEFT JOIN tbl_master_sitename C ON C.id = B.tbl_master_sitename_id					LEFT JOIN tbl_master_region D ON D.id = B.tbl_master_region_id						LEFT JOIN tbl_master_pone E ON E.id = B.tbl_master_pone_id					LEFT JOIN tbl_uploader_tracker F ON F.file_name = A.file_name					LEFT JOIN tbl_master_phase G ON G.id = B.tbl_master_phase_id					$where				";			break;			case "mcr":				$sql = "				SELECT A.*, 					B.site_id, B.site_name, B.sow_category,					C.site_status, D.region_code, E.po_ne, F.id as uploader_id,					G.phase_name, H.on_air_date				FROM tbl_master_tracker_mcr A				LEFT JOIN tbl_master_tracker_siteinfo B ON B.boqno /*siteinfo*/ = A.boqno				LEFT JOIN tbl_master_sitename C ON C.id = B.tbl_master_sitename_id				LEFT JOIN tbl_master_region D ON D.id = B.tbl_master_region_id					LEFT JOIN tbl_master_pone E ON E.id = B.tbl_master_pone_id				LEFT JOIN tbl_uploader_tracker F ON F.file_name = A.file_name				LEFT JOIN tbl_master_phase G ON G.id = B.tbl_master_phase_id				LEFT JOIN tbl_master_tracker_siteprogress H ON H.boqno = A.boqno				$where					";			break;			case "atf":				$sql = "					SELECT A.*, 					B.site_id, B.site_name, B.sow_category,					C.site_status, D.region_code, E.po_ne, F.id as uploader_id					FROM tbl_master_tracker_atf A					LEFT JOIN tbl_master_tracker_siteinfo B ON B.boqno /*siteinfo*/ = A.boqno					LEFT JOIN tbl_master_sitename C ON C.id = B.tbl_master_sitename_id					LEFT JOIN tbl_master_region D ON D.id = B.tbl_master_region_id						LEFT JOIN tbl_master_pone E ON E.id = B.tbl_master_pone_id					LEFT JOIN tbl_uploader_tracker F ON F.file_name = A.file_name					$where				";			break;			case "sitebinder":				$sql = "					SELECT A.*, 					B.site_id, B.site_name, B.sow_category,					C.site_status, D.region_code, E.po_ne, F.id as uploader_id					FROM tbl_master_tracker_sitebinder A					LEFT JOIN tbl_master_tracker_siteinfo B ON B.boqno /*siteinfo*/ = A.boqno					LEFT JOIN tbl_master_sitename C ON C.id = B.tbl_master_sitename_id					LEFT JOIN tbl_master_region D ON D.id = B.tbl_master_region_id						LEFT JOIN tbl_master_pone E ON E.id = B.tbl_master_pone_id					LEFT JOIN tbl_uploader_tracker F ON F.file_name = A.file_name					$where				";			break;			case "acceptanceclosing":				$sql = "					SELECT A.*, 					B.site_id, B.site_name, B.sow_category,					C.site_status, D.region_code, E.po_ne, F.phase_code, F.phase_name, G.id as uploader_id,					H.on_air_date, H.atp_date, I.endorse_approved					FROM tbl_master_tracker_accclosing A					LEFT JOIN tbl_master_tracker_siteinfo B ON B.boqno /*siteinfo*/ = A.boqno					LEFT JOIN tbl_master_sitename C ON C.id = B.tbl_master_sitename_id					LEFT JOIN tbl_master_region D ON D.id = B.tbl_master_region_id						LEFT JOIN tbl_master_pone E ON E.id = B.tbl_master_pone_id					LEFT JOIN tbl_master_phase F ON F.id = B.tbl_master_phase_id					LEFT JOIN tbl_uploader_tracker G ON G.file_name = A.file_name					LEFT JOIN tbl_master_tracker_siteprogress H ON H.boqno = A.boqno					LEFT JOIN tbl_master_tracker_sitebinder I ON I.boqno = A.boqno										$where				";			break;			case "costsales":				$sql = "					SELECT A.*, 					B.site_id, B.site_name, B.sow_category,					C.site_status, D.region_code, E.po_ne, F.id as uploader_id,					G.on_air_date, G.on_air_baseline					FROM tbl_master_tracker_costsales A					LEFT JOIN tbl_master_tracker_siteinfo B ON B.boqno /*siteinfo*/ = A.boqno					LEFT JOIN tbl_master_sitename C ON C.id = B.tbl_master_sitename_id					LEFT JOIN tbl_master_region D ON D.id = B.tbl_master_region_id						LEFT JOIN tbl_master_pone E ON E.id = B.tbl_master_pone_id					LEFT JOIN tbl_uploader_tracker F ON F.file_name = A.file_name					LEFT JOIN tbl_master_tracker_siteprogress G ON G.boqno = A.boqno					$where				";			break;			case "tracker_all":				$sql ="					SELECT A.*					FROM tbl_master_tracker_siteinfo A					LEFT JOIN tbl_master_tracker_siteprogress B ON B.boqno = A.boqno /*siteinfo */ AND B.tbl_master_tracker_siteinfo_id = A.id					$where				";			break;			case "uploadalldatabase":				$sql = "					SELECT A.*					FROM tbl_uploader_alldatabase A				";			break;			case "receivedall":			case "receiveddollar":			case "received":				$sql = "					SELECT A.*,						B.phase_code, B.phase_year, B.phase_name,						C.po_type,						D.po_no, D.project_name, D.basic_contract, E.currency,						F.cr_no_nokia, F.cr_status, G.id as uploader_id, G.type_database					FROM tbl_all_database A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id					LEFT JOIn tbl_master_potype C ON C.id = A.tbl_master_potype_id					LEFT JOIN tbl_master_po D ON D.id = A.tbl_master_po_id					LEFT JOIN tbl_master_pocurrency E ON E.id = D.tbl_master_currency_id					LEFT JOIN tbl_master_cr F ON F.id = A.tbl_master_cr_id					LEFT JOIN tbl_uploader_alldatabase G ON G.file_name = A.file_name					$where AND A.level = 1				";			break;			case "reservationall":			case "reservationdollar":			case "reservation":				$sql = "					SELECT A.*,						B.phase_code, B.phase_year, B.phase_name,						C.po_type,						D.po_no, D.project_name, D.basic_contract, E.currency,						F.cr_no_nokia, F.cr_status, G.id as uploader_id, G.type_database					FROM tbl_all_database A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id					LEFT JOIn tbl_master_potype C ON C.id = A.tbl_master_potype_id					LEFT JOIN tbl_master_po D ON D.id = A.tbl_master_po_id					LEFT JOIN tbl_master_pocurrency E ON E.id = D.tbl_master_currency_id					LEFT JOIN tbl_master_cr F ON F.id = A.tbl_master_cr_id					LEFT JOIN tbl_uploader_alldatabase G ON G.file_name = A.file_name					$where AND A.level = 2				";			break;			case "mapping":				$sql = "					SELECT A.*,						B.phase_code, B.phase_year, B.phase_name,						C.po_type,						D.po_no, D.project_name, D.basic_contract, E.currency,						F.cr_no_nokia, F.cr_status, G.id as uploader_id, G.type_database					FROM tbl_all_database A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id					LEFT JOIn tbl_master_potype C ON C.id = A.tbl_master_potype_id					LEFT JOIN tbl_master_po D ON D.id = A.tbl_master_po_id					LEFT JOIN tbl_master_pocurrency E ON E.id = D.tbl_master_currency_id					LEFT JOIN tbl_master_cr F ON F.id = A.tbl_master_cr_id					LEFT JOIN tbl_uploader_alldatabase G ON G.file_name = A.file_name					$where AND A.level = 1 OR A.level = 2				";			break;			case "boqpersite":				$sql = "					SELECT A.*,						B.phase_code, B.phase_year, B.phase_name,						C.po_type,						D.po_no, D.project_name, D.basic_contract, D.project_name, E.currency,						F.cr_no_nokia, F.cr_status, G.id as uploader_id, G.type_database,						H.boqno, H.site_id, H.site_name, H.network_boq, H.wp_id_svc,						I.region_code					FROM tbl_all_database A					LEFT JOIN tbl_master_phase B ON B.id = A.tbl_master_phase_id					LEFT JOIn tbl_master_potype C ON C.id = A.tbl_master_potype_id					LEFT JOIN tbl_master_po D ON D.id = A.tbl_master_po_id					LEFT JOIN tbl_master_pocurrency E ON E.id = D.tbl_master_currency_id					LEFT JOIN tbl_master_cr F ON F.id = A.tbl_master_cr_id					LEFT JOIN tbl_uploader_alldatabase G ON G.file_name = A.file_name					LEFT JOIN tbl_master_tracker_siteinfo H ON H.id = A.tbl_master_tracker_siteinfo_id					LEFT JOIN tbl_master_region I ON I.id = H.tbl_master_region_id					$where AND A.level = 2					ORDER BY H.boqno ASC, C.po_type ASC, D.po_no ASC				";			break;						//Modul User Management			case "cekusername":				$sql = "					SELECT id					FROM tbl_user A					WHERE A.nama_user = '".$p1."'				";			break;						case "userlist":				$sql = "					SELECT A.*, B.group_user					FROM tbl_user A					LEFT JOIN tbl_user_group B ON A.cl_user_group_id = B.id					$where				";			break;			case "grouplist":				$sql = "					SELECT A.*					FROM tbl_user_group A					$where				";			break;						case "menu":				$sql = "					SELECT a.tbl_menu_id, b.nama_menu, b.type_menu, b.icon_menu, b.url						FROM tbl_user_prev_group a					LEFT JOIN tbl_user_menu b ON a.tbl_menu_id = b.id 					WHERE a.cl_user_group_id=".$this->auth['cl_user_group_id']." 					AND (b.type_menu='P' OR b.type_menu='B') AND b.status=1				";				$parent = $this->db->query($sql)->result_array();				$menu = array();				foreach($parent as $v){					$menu[$v['tbl_menu_id']]=array();					$menu[$v['tbl_menu_id']]['parent']=$v['nama_menu'];					$menu[$v['tbl_menu_id']]['icon_menu']=$v['icon_menu'];					$menu[$v['tbl_menu_id']]['url']=$v['url'];					$menu[$v['tbl_menu_id']]['type_menu']=$v['type_menu'];					$menu[$v['tbl_menu_id']]['child']=array();					$sql="						SELECT a.tbl_menu_id, b.nama_menu, b.url, b.icon_menu , b.type_menu							FROM tbl_user_prev_group a						LEFT JOIN tbl_user_menu b ON a.tbl_menu_id = b.id 						WHERE a.cl_user_group_id=".$this->auth['cl_user_group_id']." 						AND (b.type_menu = 'C' OR b.type_menu = 'CHC') 						AND b.status=1 AND b.parent_id=".$v['tbl_menu_id'];					$child = $this->db->query($sql)->result_array();					foreach($child as $x){						$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]=array();						$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['menu']=$x['nama_menu'];						$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['type_menu']=$x['type_menu'];						$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['url']=$x['url'];						$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['icon_menu']=$x['icon_menu'];												if($x['type_menu'] == 'CHC'){							$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['sub_child'] = array();							$sqlSubChild="								SELECT a.tbl_menu_id, b.nama_menu, b.url, b.icon_menu , b.type_menu									FROM tbl_user_prev_group a								LEFT JOIN tbl_user_menu b ON a.tbl_menu_id = b.id 								WHERE a.cl_user_group_id=".$this->auth['cl_user_group_id']." 								AND b.type_menu = 'CC'								AND b.parent_id_2 = ".$x['tbl_menu_id']."								AND b.status=1 							";							$SubChild = $this->db->query($sqlSubChild)->result_array();							foreach($SubChild as $z){								$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['sub_child'][$z['tbl_menu_id']]['sub_menu'] = $z['nama_menu'];								$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['sub_child'][$z['tbl_menu_id']]['type_menu'] = $z['type_menu'];								$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['sub_child'][$z['tbl_menu_id']]['url'] = $z['url'];								$menu[$v['tbl_menu_id']]['child'][$x['tbl_menu_id']]['sub_child'][$z['tbl_menu_id']]['icon_menu'] = $z['icon_menu'];							}						}											}				}								/*				echo "<pre>";				print_r($menu);exit;				//*/								$array = $menu;			break;								case "menu_parent":				$sql = "					SELECT A.*					FROM tbl_user_menu A					WHERE (A.type_menu = 'P' OR A.type_menu = 'B') AND A.status = '1'				";			break;			case "menu_child":				$sql = "					SELECT A.*					FROM tbl_user_menu A					WHERE (A.type_menu = 'C' OR A.type_menu = 'CHC') AND A.parent_id = '".$p1."' AND A.status = '1'				";			break;			case "menu_child_2":				$sql = "					SELECT A.*					FROM tbl_user_menu A					WHERE A.type_menu = 'CC' AND A.parent_id_2 = '".$p1."' AND A.status = '1'				";			break;			case "previliges_menu":				$sql = "					SELECT A.*					FROM tbl_user_prev_group A					WHERE A.tbl_menu_id = '".$p1."' AND A.cl_user_group_id = '".$p2."'				";			break;						//End Modul User Management		}				if($balikan == 'json'){			return $this->lib->json_grid($sql);		}elseif($balikan == 'row_array'){			return $this->db->query($sql)->row_array();		}elseif($balikan == 'result'){			return $this->db->query($sql)->result();		}elseif($balikan == 'result_array'){			return $this->db->query($sql)->result_array();		}elseif($balikan == 'variable'){			return $array;		}			}		function get_combo($type="", $p1="", $p2=""){		switch($type){			case "tbl_master_phase":				$sql = "					SELECT A.id, CONCAT_WS('-', A.phase_code, A.phase_year) as txt					FROM $type A					WHERE A.status = '1'				";			break;			case "tbl_master_potype":				$sql = "					SELECT A.id, A.po_type as txt					FROM $type A					WHERE A.status = '1'				";			break;			case "tbl_master_pocurrency":				$sql = "					SELECT A.id, A.currency as txt					FROM $type A					WHERE A.status = '1'				";			break;			case "tbl_master_region":				$sql = "					SELECT A.id, A.region_code as txt					FROM $type A					WHERE A.status = '1'				";			break;			case "tbl_master_sitename":				$sql = "					SELECT A.id, A.site_status as txt					FROM $type A					WHERE A.status = '1'				";			break;			case "tbl_master_pone":				$sql = "					SELECT A.id, A.po_ne as txt					FROM $type A					WHERE A.status = '1'				";			break;						case "tbl_user_group":				$sql = "					SELECT A.id, A.group_user as txt					FROM $type A					WHERE A.status = '1'				";			break;		}				return $this->db->query($sql)->result_array();	}		function simpandata($table,$data,$sts_crud,$sts_inline_edit=""){ //$sts_crud --> STATUS NYEE INSERT, UPDATE, DELETE		$this->db->trans_begin();		if(isset($data['id'])){			$id = $data['id'];			unset($data['id']);		}				$data['update_by'] = $this->auth['nama_user']; 		$data['update_date'] = date('Y-m-d H:i:s'); 				switch($table){			case "tbl_master_phase":						break;			case "tbl_master_potype":							break;			case "tbl_master_pocurrency":							break;			case "tbl_master_region":							break;			case "tbl_master_sitename":							break;			case "tbl_master_pone":							break;			case "tbl_master_po":				//$data['po_gross_usd'] = ($data['po_gross_idr'] / $data['jis_dorr_rate']);				//$data['po_nett_usd'] = ($data['po_nett_idr'] / $data['jis_dorr_rate']);			break;			case "tbl_master_cr":							break;						case "tbl_master_tracker_siteinfo":				if($sts_inline_edit = "inline_edit"){										unset($data['phase_code']);					unset($data['phase_name']);					unset($data['site_status']);					unset($data['region_code']);					unset($data['po_ne']);					unset($data['uploader_id']);					unset($data['editing']);				}			break;			case "tbl_master_tracker_siteprogress":				if($sts_inline_edit = "inline_edit"){										unset($data['site_id']);					unset($data['site_name']);					unset($data['sow_category']);					unset($data['partner_ni']);					unset($data['site_status']);					unset($data['region_code']);					unset($data['po_ne']);					unset($data['uploader_id']);					unset($data['phase_year']);					unset($data['phase_name']);					unset($data['editing']);				}			break;			case "tbl_master_tracker_mcr":							break;			case "tbl_master_tracker_atf":							break;			case "tbl_master_tracker_sitebinder":							break;			case "tbl_master_tracker_costsales";						break;			case "tbl_master_tracker_costsales";						break;			case "tbl_all_database";							break;						// Modul User Management			case "tbl_user":				if($sts_crud == 'add' || $sts_crud == 'edit'){					$this->load->library('encrypt');					$data['password'] = $this->encrypt->encode($data['password']);				}			break;			case "user_role_group":				$id_group = $id;				$this->db->delete('tbl_user_prev_group', array('cl_user_group_id'=>$id_group) );				if(isset($data['data'])){					$postdata = $data['data'];					$row=array();					foreach($postdata as $v){						$pecah = explode("_",$v);						$row["buat"]=0;						$row["baca"]=0;						$row["ubah"]=0;						$row["hapus"]=0;												switch($pecah[0]){							case "C":								$row["buat"]=1;							break;							case "R":								$row["baca"]=1;							break;							case "U":								$row["ubah"]=1;							break;							case "D":								$row["hapus"]=1;							break;						}												$row["tbl_menu_id"] = $pecah[1];						$row["cl_user_group_id"] = $id_group;												$cek_data = $this->db->get_where('tbl_user_prev_group', array('tbl_menu_id'=>$pecah[1], 'cl_user_group_id'=>$id_group) )->row_array();						if(!$cek_data){							$this->db->insert('tbl_user_prev_group', $row);						}else{							if($row["buat"]==0)unset($row["buat"]);							if($row["baca"]==0)unset($row["baca"]);							if($row["ubah"]==0)unset($row["ubah"]);							if($row["hapus"]==0)unset($row["hapus"]);														$this->db->update('tbl_user_prev_group', $row, array('tbl_menu_id'=>$pecah[1], 'cl_user_group_id'=>$id_group) );						}					}					}			break;			// End Modul User Management		}				switch ($sts_crud){			case "add": 				$data['status'] = 1;				$this->db->insert($table,$data);			break;			case "edit":				$this->db->update($table, $data, array('id' => $id) );			break;			case "inactive":				$data['status'] = 0;				$this->db->update($table, $data, array('id' => $id) );			break;			case "activate":				$data['status'] = 1;				$this->db->update($table, $data, array('id' => $id) );			break;		}				if($this->db->trans_status() == false){			$this->db->trans_rollback();			return 'gagal';		}else{			 return $this->db->trans_commit();		}	}		function importdata($type=""){		$this->load->library("PHPExcel");		if(!empty($_FILES['file_import']['name'])){			//$this->db->trans_begin();						$ext = explode('.',$_FILES['file_import']['name']);			$exttemp = sizeof($ext) - 1;			$extension = $ext[$exttemp];						$upload_path = "./__repository/tmp_upload/";			$filen = $ext[0]."-".date('Ymd_His').".".$extension;			$filename =  $this->lib->uploadnong($upload_path, 'file_import', $filen);						$folder_aplod = $upload_path.$filename;			$cacheMethod   = PHPExcel_CachedObjectStorageFactory::cache_to_phpTemp;			$cacheSettings = array('memoryCacheSize' => '1600MB');			PHPExcel_Settings::setCacheStorageMethod($cacheMethod,$cacheSettings);			if($extension=='xls'){				$lib="Excel5";			}else{				$lib="Excel2007";			}						$objReader =  PHPExcel_IOFactory::createReader($lib);//excel2007			ini_set('max_execution_time', 123456);			//end set						$objPHPExcel = $objReader->load($folder_aplod); 			$objReader->setReadDataOnly(true);			$nama_sheet=$objPHPExcel->getSheetNames();			$worksheet = $objPHPExcel->setActiveSheetIndex(0);			$array_benar = array();			$array_salah = array();			$method = $this->input->post('methodupload');			$insertbatchstatus = true;						switch($type){				case "masterpo":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arrayphasesalah = array();						$arraypotypesalah = array();						$arraycurrencysalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arrayphase = array(								'phase_code' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$cekphase = $this->db->get_where('tbl_master_phase', $arrayphase)->row_array();							if(isset($cekphase)){								$tbl_master_phase_id = $cekphase['id'];							}else{								$statusdata = false;								$arrayphasesalah['phase_code'] = $worksheet->getCell("B".$i)->getCalculatedValue();								$arrayphasesalah['phase_name'] = $worksheet->getCell("D".$i)->getCalculatedValue();								$arrayphasesalah['phase_year'] = $worksheet->getCell("C".$i)->getCalculatedValue();							}						}						if($worksheet->getCell("E".$i)->getCalculatedValue() != ""){							$arraypotype = array(								'po_type' => $worksheet->getCell("E".$i)->getCalculatedValue(),							);							$cekpotype = $this->db->get_where('tbl_master_potype', $arraypotype)->row_array();							if(isset($cekpotype)){								$tbl_master_potype_id = $cekpotype['id'];							}else{								$statusdata = false;								$arraypotypesalah['po_type'] = $worksheet->getCell("E".$i)->getCalculatedValue();							}						}						if($worksheet->getCell("H".$i)->getCalculatedValue() != ""){							$arraycurrency = array(								'currency' => $worksheet->getCell("H".$i)->getCalculatedValue(),							);							$cekcurrency = $this->db->get_where('tbl_master_pocurrency', $arraycurrency)->row_array();							if(isset($cekcurrency)){								$tbl_master_currency_id = $cekcurrency['id'];							}else{								$statusdata = false;								$arraycurrencysalah['currency'] = $worksheet->getCell("H".$i)->getCalculatedValue();							}						}												if($statusdata == true){																					$podatet = $worksheet->getCell("J".$i)->getCalculatedValue();							if ($podatet == null){								$podate = null;							}else{								$podatet = new DateTime("1899-12-30 + $podatet days");								$podate = $podatet->format('Y-m-d');							}							//$podatet = new DateTime("1899-12-30 + $podatet days");							//$podate = $podatet->format('Y-m-d');																					//$podatet = DateTime::createFromFormat('d/m/y', $worksheet->getCell("J".$i)->getCalculatedValue());							//$podate =  $podatet->format('Y-m-d');														$poreceivedt = $worksheet->getCell("K".$i)->getCalculatedValue();							if ($poreceivedt == null){								$poreceived = null;							}else{								$poreceivedt = new DateTime("1899-12-30 + $poreceivedt days");								$poreceived = $poreceivedt->format('Y-m-d');							}							//$poreceivedt = new DateTime("1899-12-30 + $poreceivedt days");							//$poreceived = $poreceivedt->format('Y-m-d');														$podeliveryt = $worksheet->getCell("L".$i)->getCalculatedValue();							if ($podeliveryt == null){								$podelivery = null;							}else{								$podeliveryt = new DateTime("1899-12-30 + $podeliveryt days");								$podelivery = $podeliveryt->format('Y-m-d');								$podeliveryn = $worksheet->getCell("L".$i)->getCalculatedValue();							}							//$podeliveryt = new DateTime("1899-12-30 + $podeliveryt days");							//$podelivery = $podeliveryt->format('Y-m-d');									$arrayinsertbenar = array(								'tbl_master_phase_id' => $tbl_master_phase_id,								'tbl_master_potype_id' => $tbl_master_potype_id,								'tbl_master_currency_id' => $tbl_master_currency_id,								'po_no' => $worksheet->getCell("F".$i)->getCalculatedValue(),								'project_name' => $worksheet->getCell("G".$i)->getCalculatedValue(),								'basic_contract' => $worksheet->getCell("I".$i)->getCalculatedValue(),								'po_date' => $podate,								'po_received' => $poreceived,								'po_delivery' => $podelivery,								'revision_no' => $worksheet->getCell("M".$i)->getCalculatedValue(),								'po_gross_idr' => $worksheet->getCell("N".$i)->getCalculatedValue(),								'po_nett_idr' => $worksheet->getCell("O".$i)->getCalculatedValue(),								'jis_dorr_rate' => $worksheet->getCell("P".$i)->getCalculatedValue(),								'po_gross_usd' => ($worksheet->getCell("N".$i)->getCalculatedValue() / $worksheet->getCell("P".$i)->getCalculatedValue()),								'po_nett_usd' => ($worksheet->getCell("O".$i)->getCalculatedValue() / $worksheet->getCell("P".$i)->getCalculatedValue()),								'po_nett_usd' => $worksheet->getCell("R".$i)->getCalculatedValue(),								'remarks' => $worksheet->getCell("S".$i)->getCalculatedValue(),								'file_name' => $filen,								'update_by' => $this->auth['nama_user'],								'update_date' => date('Y-m-d H:i:s'),								'status' => 1							);														if($method == 'N'){								array_push($array_benar, $arrayinsertbenar);							}elseif($method == 'U'){								$id = $worksheet->getCell("A".$i)->getCalculatedValue();								if($id){									$this->db->update('tbl_master_po', $arrayinsertbenar, array('id'=>$id) );								}							}						}else{							$arrayinsertsalah = array(								'row' => $i,								'phase' => $arrayphasesalah,								'potype' => $arraypotypesalah,								'currency' => $arraycurrencysalah							);							array_push($array_salah, $arrayinsertsalah);						}					if($method == 'U'){						if($statusdata == true) echo $statusdata;exit;					}					}					$table = "tbl_master_po";									break;				case "mastercr":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arrayphasesalah = array();						if($worksheet->getCell("E".$i)->getCalculatedValue() != ""){							$arrayphase = array(								'phase_code' => $worksheet->getCell("E".$i)->getCalculatedValue(),							);							$cekphase = $this->db->get_where('tbl_master_phase', $arrayphase)->row_array();							if(isset($cekphase)){								$tbl_master_phase_id = $cekphase['id'];							}else{								$statusdata = false;								$arrayphasesalah['phase_code'] = $worksheet->getCell("E".$i)->getCalculatedValue();								$arrayphasesalah['phase_name'] = $worksheet->getCell("F".$i)->getCalculatedValue();								$arrayphasesalah['phase_year'] = $worksheet->getCell("G".$i)->getCalculatedValue();							}						}												if($statusdata == true){							//$crsubmit 	= date_format(date_create_from_format('m/d/Y', $worksheet->getCell("K".$i)->getCalculatedValue()), 'Y-m-d');							//$crapproved = date_format(date_create_from_format('m/d/Y', $worksheet->getCell("L".$i)->getCalculatedValue()), 'Y-m-d');							//$poreceived = date_format(date_create_from_format('m/d/Y', $worksheet->getCell("M".$i)->getCalculatedValue()), 'Y-m-d');														$crsubmitt = $worksheet->getCell("K".$i)->getCalculatedValue();							if ($crsubmitt == null){								$crsubmit = null;							}else{								$crsubmitt = new DateTime("1899-12-30 + $crsubmitt days");								$crsubmit = $crsubmitt->format('Y-m-d');							}							//$crsubmitt = new DateTime("1899-12-30 + $crsubmitt days");							//$crsubmit = $crsubmitt->format('Y-m-d');														$crapprovedt = $worksheet->getCell("L".$i)->getCalculatedValue();							if ($crapprovedt == null){								$crapproved = null;							}else{								$crapprovedt = new DateTime("1899-12-30 + $crapprovedt days");								$crapproved = $crapprovedt->format('Y-m-d');							}							//$crapprovedt = new DateTime("1899-12-30 + $crapprovedt days");							//$crapproved = $crapprovedt->format('Y-m-d');														$poreceivedt = $worksheet->getCell("M".$i)->getCalculatedValue();							if ($poreceivedt == null){								$poreceived = null;							}else{								$poreceivedt = new DateTime("1899-12-30 + $poreceivedt days");								$poreceived = $poreceivedt->format('Y-m-d');							}							//$poreceivedt = new DateTime("1899-12-30 + $poreceivedt days");							//$poreceived = $poreceivedt->format('Y-m-d');														$arrayinsertbenar = array(								'tbl_master_phase_id' => $tbl_master_phase_id,								'cr_no_nokia' => $worksheet->getCell("B".$i)->getCalculatedValue(),								'cr_no_indosat' => $worksheet->getCell("C".$i)->getCalculatedValue(),								'cr_status' => $worksheet->getCell("D".$i)->getCalculatedValue(),								'nodin' => $worksheet->getCell("H".$i)->getCalculatedValue(),								'cr_position' => $worksheet->getCell("I".$i)->getCalculatedValue(),								'cr_pic' => $worksheet->getCell("J".$i)->getCalculatedValue(),								'cr_submit' => $crsubmit,								'cr_approved' => $crapproved,								'po_received' => $poreceived,								'cr_currency' => $worksheet->getCell("N".$i)->getCalculatedValue(),									'value_before' => $worksheet->getCell("O".$i)->getCalculatedValue(),									'value_after' => $worksheet->getCell("P".$i)->getCalculatedValue(),								'value_delta' => ($worksheet->getCell("O".$i)->getCalculatedValue() - $worksheet->getCell("P".$i)->getCalculatedValue()),								'cr_type' => $worksheet->getCell("R".$i)->getCalculatedValue(),								'value_additional' => $worksheet->getCell("S".$i)->getCalculatedValue(),								'value_reduction' => $worksheet->getCell("T".$i)->getCalculatedValue(),								'remarks' => $worksheet->getCell("U".$i)->getCalculatedValue(),								'file_name' => $filen,								'update_by' => $this->auth['nama_user'],								'update_date' => date('Y-m-d H:i:s'),								'status' => 1							);														if($method == 'N'){								array_push($array_benar, $arrayinsertbenar);							}elseif($method == 'U'){								$id = $worksheet->getCell("A".$i)->getCalculatedValue();								if($id){									$this->db->update('tbl_master_cr', $arrayinsertbenar, array('id'=>$id) );								} 							}						}else{							$arrayinsertsalah = array(								'row' => $i,								'phase' => $arrayphasesalah							);							array_push($array_salah, $arrayinsertsalah);						}					}					$table = "tbl_master_cr";									break;				case "siteinfo":					$boquery = true;					$boqaseli = 1;					$arrayboq = array();					//echo $worksheet->getHighestRow();exit;					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						if($worksheet->getCell("J".$i)->getCalculatedValue() != ""){							$statusdata = true;							$arrayphasesalah = array();							$arrayregionsalah = array();							$arraysitestatussalah = array();							$arrayponesalah = array();							if($worksheet->getCell("J".$i)->getCalculatedValue() != ""){								$arrayphase = array(									'phase_code' => $worksheet->getCell("J".$i)->getCalculatedValue(),								);								$cekphase = $this->db->get_where('tbl_master_phase', $arrayphase)->row_array();								if(isset($cekphase)){									$tbl_master_phase_id = $cekphase['id'];								}else{									$statusdata = false;									$arrayphasesalah['phase_code'] = $worksheet->getCell("J".$i)->getCalculatedValue();									$arrayphasesalah['phase_name'] = $worksheet->getCell("K".$i)->getCalculatedValue();								}							}							if($worksheet->getCell("G".$i)->getCalculatedValue() != ""){								$arrayregion = array(									'region_code' => $worksheet->getCell("G".$i)->getCalculatedValue(),								);								$cekregion = $this->db->get_where('tbl_master_region', $arrayregion)->row_array();								if(isset($cekregion)){									$tbl_master_region_id = $cekregion['id'];								}else{									$statusdata = false;									$arrayregionsalah['region_code'] = $worksheet->getCell("G".$i)->getCalculatedValue();								}							}							if($worksheet->getCell("F".$i)->getCalculatedValue() != ""){								$arraysitestatus = array(									'site_status' => $worksheet->getCell("F".$i)->getCalculatedValue(),								);								$ceksitestatus = $this->db->get_where('tbl_master_sitename', $arraysitestatus)->row_array();								if(isset($ceksitestatus)){									$tbl_master_sitename_id = $ceksitestatus['id'];								}else{									$statusdata = false;									$arraysitestatussalah['sitestatus'] = $worksheet->getCell("F".$i)->getCalculatedValue();								}							}							if($worksheet->getCell("P".$i)->getCalculatedValue() != ""){								$arrayponesalah = array(									'po_ne' => $worksheet->getCell("P".$i)->getCalculatedValue(),								);								$cekpone = $this->db->get_where('tbl_master_pone', $arrayponesalah)->row_array();								if(isset($cekpone)){									$tbl_master_pone_id = $cekpone['id'];								}else{									$statusdata = false;									$arrayponesalah['pone'] = $worksheet->getCell("P".$i)->getCalculatedValue();								}							}														if($statusdata == true){								if($method == 'N'){									if($boquery == true){										$sqlboq = "											SELECT MAX(boqmaxid) as boq_max											FROM tbl_master_tracker_siteinfo											WHERE tbl_master_phase_id = '".$tbl_master_phase_id."'										";																				$queryboq = $this->db->query($sqlboq)->row_array();										if($queryboq['boq_max'] != null){											$boqno = ($queryboq['boq_max'] + 1);											$boqno = $worksheet->getCell("J".$i)->getCalculatedValue()."".sprintf('%04d', $boqno);											$boqaseli = ($queryboq['boq_max'] + 1);										}else{											$boqaseli = 1;											$boqno = $worksheet->getCell("J".$i)->getCalculatedValue()."0001";										}																				$boquery = false;									}else{										$boqaseli = ($boqaseli + 1);										$boqno = $worksheet->getCell("J".$i)->getCalculatedValue()."".sprintf('%04d', $boqaseli);										$boquery = false;									}									$arrayinsertbenar = array(										'tbl_master_phase_id' => $tbl_master_phase_id,										'tbl_master_region_id' => $tbl_master_region_id,										'tbl_master_sitename_id' => $tbl_master_sitename_id,										'tbl_master_pone_id' => $tbl_master_pone_id,										'boqno' => $boqno,										'site_id' => $worksheet->getCell("C".$i)->getCalculatedValue(),										'site_name' => $worksheet->getCell("D".$i)->getCalculatedValue(),										'sow_category' => $worksheet->getCell("E".$i)->getCalculatedValue(),										'area_name' => $worksheet->getCell("H".$i)->getCalculatedValue(),										'cluster' => $worksheet->getCell("I".$i)->getCalculatedValue(),										'sow_detail' => $worksheet->getCell("L".$i)->getCalculatedValue(),										'system_key' => $worksheet->getCell("M".$i)->getCalculatedValue(),										'site_id_ori' => $worksheet->getCell("N".$i)->getCalculatedValue(),										'site_name_ori' => $worksheet->getCell("O".$i)->getCalculatedValue(),										'network_boq' => $worksheet->getCell("Q".$i)->getCalculatedValue(),										'wp_id_svc' => $worksheet->getCell("R".$i)->getCalculatedValue(),										'so_svc' => $worksheet->getCell("S".$i)->getCalculatedValue(),										'partner_ni' => $worksheet->getCell("T".$i)->getCalculatedValue(),										'partner_npo' => $worksheet->getCell("U".$i)->getCalculatedValue(),										'remarks_siteinfo' => $worksheet->getCell("V".$i)->getCalculatedValue(),																				'status' => 1,										'update_by' => $this->auth['nama_user'],										'update_date' => date('Y-m-d H:i:s'),										'file_name' => $filen,										'boqmaxid' => $boqaseli									);								}elseif($method == 'U'){									$boqno = $worksheet->getCell("B".$i)->getCalculatedValue();									$arrayinsertbenar = array(										'tbl_master_phase_id' => $tbl_master_phase_id,										'tbl_master_region_id' => $tbl_master_region_id,										'tbl_master_sitename_id' => $tbl_master_sitename_id,										'tbl_master_pone_id' => $tbl_master_pone_id,																				'site_id' => $worksheet->getCell("C".$i)->getCalculatedValue(),										'site_name' => $worksheet->getCell("D".$i)->getCalculatedValue(),										'sow_category' => $worksheet->getCell("E".$i)->getCalculatedValue(),										'area_name' => $worksheet->getCell("H".$i)->getCalculatedValue(),										'cluster' => $worksheet->getCell("I".$i)->getCalculatedValue(),										'sow_detail' => $worksheet->getCell("L".$i)->getCalculatedValue(),										'system_key' => $worksheet->getCell("M".$i)->getCalculatedValue(),										'site_id_ori' => $worksheet->getCell("N".$i)->getCalculatedValue(),										'site_name_ori' => $worksheet->getCell("O".$i)->getCalculatedValue(),										'network_boq' => $worksheet->getCell("Q".$i)->getCalculatedValue(),										'wp_id_svc' => $worksheet->getCell("R".$i)->getCalculatedValue(),										'so_svc' => $worksheet->getCell("S".$i)->getCalculatedValue(),										'partner_ni' => $worksheet->getCell("T".$i)->getCalculatedValue(),										'partner_npo' => $worksheet->getCell("U".$i)->getCalculatedValue(),										'remarks_siteinfo' => $worksheet->getCell("V".$i)->getCalculatedValue(),																				'status' => 1,										'update_by' => $this->auth['nama_user'],										'update_date' => date('Y-m-d H:i:s'),										'file_name' => $filen,										'boqmaxid' => $boqaseli									);								}																		/*$arrayinsertbenar = array(										'tbl_master_phase_id' => $tbl_master_phase_id,										'tbl_master_region_id' => $tbl_master_region_id,										'tbl_master_sitename_id' => $tbl_master_sitename_id,										'tbl_master_pone_id' => $tbl_master_pone_id,										'boqno' => $boqno,										'site_id' => $worksheet->getCell("C".$i)->getCalculatedValue(),										'site_name' => $worksheet->getCell("D".$i)->getCalculatedValue(),										'sow_category' => $worksheet->getCell("E".$i)->getCalculatedValue(),										'area_name' => $worksheet->getCell("H".$i)->getCalculatedValue(),										'cluster' => $worksheet->getCell("I".$i)->getCalculatedValue(),										'sow_detail' => $worksheet->getCell("L".$i)->getCalculatedValue(),										'system_key' => $worksheet->getCell("M".$i)->getCalculatedValue(),										'site_id_ori' => $worksheet->getCell("N".$i)->getCalculatedValue(),										'site_name_ori' => $worksheet->getCell("O".$i)->getCalculatedValue(),										'network_boq' => $worksheet->getCell("Q".$i)->getCalculatedValue(),										'wp_id_svc' => $worksheet->getCell("R".$i)->getCalculatedValue(),										'so_svc' => $worksheet->getCell("S".$i)->getCalculatedValue(),										'partner_ni' => $worksheet->getCell("T".$i)->getCalculatedValue(),										'partner_npo' => $worksheet->getCell("U".$i)->getCalculatedValue(),										'remarks_siteinfo' => $worksheet->getCell("V".$i)->getCalculatedValue(),																				'status' => 1,										'update_by' => $this->auth['nama_user'],										'update_date' => date('Y-m-d H:i:s'),										'file_name' => $filen,										'boqmaxid' => $boqaseli									); */								if($method == 'N'){									$arrayisiboq = array(										'boqno' => $boqno									);																		array_push($array_benar, $arrayinsertbenar);									array_push($arrayboq, $arrayisiboq);								}elseif($method == 'U'){									$id = $worksheet->getCell("A".$i)->getCalculatedValue();									if($id){										unset($arrayinsertbenar['boqmaxid']);										$this->db->update('tbl_master_tracker_siteinfo', $arrayinsertbenar, array('id'=>$id) );									}								}															}else{								$arrayinsertsalah = array(									'row' => $i,									'phase' => $arrayphasesalah,									'region' => $arrayregionsalah,									'sitestatus' => $arraysitestatussalah,									'pone' => $arrayponesalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if(empty($array_salah)){						$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					if($method == 'U'){						if($statusdata == true) echo $statusdata;exit;					}					if(!empty($arrayboq)){						$this->db->insert_batch('tbl_master_tracker_siteprogress', $arrayboq);						$this->db->insert_batch('tbl_master_tracker_sitebinder', $arrayboq);						$this->db->insert_batch('tbl_master_tracker_mcr', $arrayboq);						$this->db->insert_batch('tbl_master_tracker_costsales', $arrayboq);						$this->db->insert_batch('tbl_master_tracker_atf', $arrayboq);						$this->db->insert_batch('tbl_master_tracker_accclosing', $arrayboq);					}										$table = "tbl_master_tracker_siteinfo";									break;				case "siteprogress":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arraysiteinfosalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arraysiteinfo = array(								'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arraysiteinfo)->row_array();							if(isset($ceksiteinfo)){								$rfit = $worksheet->getCell("I".$i)->getCalculatedValue();								if ($rfit == null){									$rfi = null;								}else{									$rfit = new DateTime("1899-12-30 + $rfit days");									$rfi = $rfit->format('Y-m-d');								}								//$rfit = new DateTime("1899-12-30 + $rfit days");								//$rfi = $rfit->format('Y-m-d');																$tsst = $worksheet->getCell("J".$i)->getCalculatedValue();								if ($tsst == null){									$tss = null;								}else{									$tsst = new DateTime("1899-12-30 + $tsst days");									$tss = $tsst->format('Y-m-d');								}								//$tsst = new DateTime("1899-12-30 + $tsst days");								//$tss = $tsst->format('Y-m-d');								$most = $worksheet->getCell("K".$i)->getCalculatedValue();								if ($most == null){									$mos = null;								}else{									$most = new DateTime("1899-12-30 + $most days");									$mos = $most->format('Y-m-d');								}								//$most = new DateTime("1899-12-30 + $most days");								//$mos = $most->format('Y-m-d');																$installedt = $worksheet->getCell("L".$i)->getCalculatedValue();								if ($installedt == null){									$installed = null;								}else{									$installedt = new DateTime("1899-12-30 + $installedt days");									$installed = $installedt->format('Y-m-d');								}								//$installedt = new DateTime("1899-12-30 + $installedt days");								//$installed = $installedt->format('Y-m-d');								$g900t = $worksheet->getCell("M".$i)->getCalculatedValue();								if ($g900t == null){									$g900 = null;								}else{									$g900t = new DateTime("1899-12-30 + $g900t days");									$g900 = $g900t->format('Y-m-d');								}								//$g900t = new DateTime("1899-12-30 + $g900t days");								//$g900 = $g900t->format('Y-m-d');																$g1800t = $worksheet->getCell("N".$i)->getCalculatedValue();								if ($g1800t == null){									$g1800 = null;								}else{									$g1800t = new DateTime("1899-12-30 + $g1800t days");									$g1800 = $g1800t->format('Y-m-d');								}								//$g1800t = new DateTime("1899-12-30 + $g1800t days");								//$g1800 = $g1800t->format('Y-m-d');								$u2100t = $worksheet->getCell("O".$i)->getCalculatedValue();								if ($u2100t == null){									$u2100 = null;								}else{									$u2100t = new DateTime("1899-12-30 + $u2100t days");									$u2100 = $u2100t->format('Y-m-d');								}								//$u2100t = new DateTime("1899-12-30 + $u2100t days");								//$u2100 = $u2100t->format('Y-m-d');																$u900t = $worksheet->getCell("P".$i)->getCalculatedValue();								if ($u900t == null){									$u900 = null;								}else{									$u900t = new DateTime("1899-12-30 + $u900t days");									$u900 = $u900t->format('Y-m-d');								}//$u900t = new DateTime("1899-12-30 + $u900t days");								//$u900 = $u900t->format('Y-m-d');								$l1800t = $worksheet->getCell("Q".$i)->getCalculatedValue();								if ($l1800t == null){									$l1800 = null;								}else{									$l1800t = new DateTime("1899-12-30 + $l1800t days");									$l1800 = $l1800t->format('Y-m-d');								}							//$l1800t = new DateTime("1899-12-30 + $l1800t days");								//$l1800 = $l1800t->format('Y-m-d');																$on_air_baselinet = $worksheet->getCell("R".$i)->getCalculatedValue();								if ($on_air_baselinet == null){									$on_air_baseline = null;								}else{									$on_air_baselinet = new DateTime("1899-12-30 + $on_air_baselinet days");									$on_air_baseline = $on_air_baselinet->format('Y-m-d');								}								//$on_air_baselinet = new DateTime("1899-12-30 + $on_air_baselinet days");								//$on_air_baseline = $on_air_baselinet->format('Y-m-d');												$on_air_datet = $worksheet->getCell("S".$i)->getCalculatedValue();								if ($on_air_datet == null){									$on_air_date = null;								}else{									$on_air_datet = new DateTime("1899-12-30 + $on_air_datet days");									$on_air_date = $on_air_datet->format('Y-m-d');								}								//$on_air_datet = new DateTime("1899-12-30 + $on_air_datet days");								//$on_air_date = $on_air_datet->format('Y-m-d');																$atp_datet = $worksheet->getCell("U".$i)->getCalculatedValue();								if ($atp_datet == null){									$atp_date = null;								}else{									$atp_datet = new DateTime("1899-12-30 + $atp_datet days");									$atp_date = $atp_datet->format('Y-m-d');								}								//$atp_datet = new DateTime("1899-12-30 + $atp_datet days");								//$atp_date = $atp_datet->format('Y-m-d');																$arrayinsertbenar =  array(									'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_tracker_siteinfo_id' => $ceksiteinfo['id'],									'rfi' => $rfi,									'tss' => $tss,									'mos' => $mos,									'installed' => $installed,									'g900' => $g900,									'g1800' => $g1800,									'u2100' => $u2100,									'u900' => $u900,									'l1800' => $l1800,									'on_air_baseline' => $on_air_baseline,									'on_air_date' => $on_air_date,									'on_air_week' => $worksheet->getCell("T".$i)->getCalculatedValue(),									'atp_date' => $atp_date,									'atp_method' => $worksheet->getCell("V".$i)->getCalculatedValue(),									'indosat_pic' => $worksheet->getCell("X".$i)->getCalculatedValue(),									'status' => 1,									'file_name' => $filen,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),								);								//$this->db->update('tbl_master_tracker_siteprogress', $arraysiteprogress, array('boqno'=>$worksheet->getCell("B".$i)->getCalculatedValue()) );								array_push($array_benar, $arrayinsertbenar);							}else{								$statusdata = false;								$arraysiteinfosalah['id'] = $worksheet->getCell("A".$i)->getCalculatedValue();								$arraysiteinfosalah['boqno'] = $worksheet->getCell("B".$i)->getCalculatedValue();							}														if($statusdata == false){								$arrayinsertsalah = array(									'row' => $i,									'siteinfo' => $arraysiteinfosalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if($array_benar){						foreach($array_benar as $k => $v){							$this->db->update('tbl_master_tracker_siteprogress', $array_benar[$k], array('boqno'=>$v['boqno']) );						}												$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					$insertbatchstatus = false;				break;				case "mcr":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arraysiteinfosalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arraysiteinfo = array(								'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arraysiteinfo)->row_array();							if(isset($ceksiteinfo)){								$alarm_submitt = $worksheet->getCell("I".$i)->getCalculatedValue();								$alarm_submitt = new DateTime("1899-12-30 + $alarm_submitt days");								$alarm_submit = $alarm_submitt->format('Y-m-d');																$alarm_approvedt = $worksheet->getCell("J".$i)->getCalculatedValue();								$alarm_approvedt = new DateTime("1899-12-30 + $alarm_approvedt days");								$alarm_approved = $alarm_approvedt->format('Y-m-d');																$ssv_fr_submitt = $worksheet->getCell("K".$i)->getCalculatedValue();								$ssv_fr_submitt = new DateTime("1899-12-30 + $ssv_fr_submitt days");								$ssv_fr_submit = $ssv_fr_submitt->format('Y-m-d');																$ssv_vr_approvedt = $worksheet->getCell("L".$i)->getCalculatedValue();								$ssv_vr_approvedt = new DateTime("1899-12-30 + $ssv_vr_approvedt days");								$ssv_vr_approved = $ssv_vr_approvedt->format('Y-m-d');																$ssv_frftr_submitt = $worksheet->getCell("M".$i)->getCalculatedValue();								$ssv_frftr_submitt = new DateTime("1899-12-30 + $ssv_frftr_submitt days");								$ssv_frftr_submit = $ssv_frftr_submitt->format('Y-m-d');																$ftr_srftr_approvedt = $worksheet->getCell("N".$i)->getCalculatedValue();								$ftr_srftr_approvedt = new DateTime("1899-12-30 + $ftr_srftr_approvedt days");								$ftr_srftr_approved = $ftr_srftr_approvedt->format('Y-m-d');																$pmr_lv_submitt = $worksheet->getCell("O".$i)->getCalculatedValue();								$pmr_lv_submitt = new DateTime("1899-12-30 + $pmr_lv_submitt days");								$pmr_lv_submit = $pmr_lv_submitt->format('Y-m-d');																$pmr_lv_approvedt = $worksheet->getCell("P".$i)->getCalculatedValue();								$pmr_lv_approvedt = new DateTime("1899-12-30 + $pmr_lv_approvedt days");								$pmr_lv_approved = $pmr_lv_approvedt->format('Y-m-d');																$rtwp_rssit = $worksheet->getCell("Q".$i)->getCalculatedValue();								$rtwp_rssit = new DateTime("1899-12-30 + $rtwp_rssit days");								$rtwp_rssi = $rtwp_rssit->format('Y-m-d');																$hn_submitt = $worksheet->getCell("R".$i)->getCalculatedValue();								$hn_submitt = new DateTime("1899-12-30 + $hn_submitt days");								$hn_submit = $hn_submitt->format('Y-m-d');																$hn_approvedt = $worksheet->getCell("S".$i)->getCalculatedValue();								$hn_approvedt = new DateTime("1899-12-30 + $hn_approvedt days");								$hn_approved = $hn_approvedt->format('Y-m-d');																$mcr_submitt = $worksheet->getCell("T".$i)->getCalculatedValue();								$mcr_submitt = new DateTime("1899-12-30 + $mcr_submitt days");								$mcr_submit = $mcr_submitt->format('Y-m-d');																$mcr_exitt = $worksheet->getCell("U".$i)->getCalculatedValue();								$mcr_exitt = new DateTime("1899-12-30 + $mcr_exitt days");								$mcr_exit = $mcr_exitt->format('Y-m-d');																$arrayinsertbenar =  array(									'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_tracker_siteinfo_id' => $ceksiteinfo['id'],									'alarm_submit' => $alarm_submit,									'alarm_approved' => $alarm_approved,									'ssv_fr_submit' => $ssv_fr_submit,									'ssv_vr_approved' => $ssv_vr_approved,									'ssv_frftr_submit' => $ssv_frftr_submit,									'ftr_srftr_approved' => $ftr_srftr_approved,									'pmr_lv_submit' => $pmr_lv_submit,									'pmr_lv_approved' => $pmr_lv_approved,									'rtwp_rssi' => $rtwp_rssi,									'hn_submit' => $hn_submit,									'hn_approved' => $hn_approved,									'mcr_submit' => $mcr_submit,									'mcr_exit' => $mcr_exit,									'file_name' => $filen,									'status' => 1,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),								);								//$this->db->update('tbl_master_tracker_siteprogress', $arraysiteprogress, array('boqno'=>$worksheet->getCell("B".$i)->getCalculatedValue()) );								array_push($array_benar, $arrayinsertbenar);							}else{								$statusdata = false;								$arraysiteinfosalah['id'] = $worksheet->getCell("A".$i)->getCalculatedValue();								$arraysiteinfosalah['boqno'] = $worksheet->getCell("B".$i)->getCalculatedValue();							}														if($statusdata == false){								$arrayinsertsalah = array(									'row' => $i,									'siteinfo' => $arraysiteinfosalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if($array_benar){						foreach($array_benar as $k => $v){							$this->db->update('tbl_master_tracker_mcr', $array_benar[$k], array('boqno'=>$v['boqno']) );						}												$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					$insertbatchstatus = false;				break;				case "atf":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arraysiteinfosalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arraysiteinfo = array(								'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arraysiteinfo)->row_array();							if(isset($ceksiteinfo)){								$atf_submitt = $worksheet->getCell("I".$i)->getCalculatedValue();								$atf_submitt = new DateTime("1899-12-30 + $atf_submitt days");								$atf_submit = $atf_submitt->format('Y-m-d');																$atf_approved1t = $worksheet->getCell("J".$i)->getCalculatedValue();								$atf_approved1t = new DateTime("1899-12-30 + $atf_approved1t days");								$atf_approved1 = $atf_approved1t->format('Y-m-d');																$dismantlet = $worksheet->getCell("K".$i)->getCalculatedValue();								$dismantlet = new DateTime("1899-12-30 + $dismantlet days");								$dismantle = $dismantlet->format('Y-m-d');																$material_pickupt = $worksheet->getCell("L".$i)->getCalculatedValue();								$material_pickupt = new DateTime("1899-12-30 + $material_pickupt days");								$material_pickup = $material_pickupt->format('Y-m-d');																$material_inbound_nokiat = $worksheet->getCell("M".$i)->getCalculatedValue();								$material_inbound_nokiat = new DateTime("1899-12-30 + $material_inbound_nokiat days");								$material_inbound_nokia = $material_inbound_nokiat->format('Y-m-d');																$material_inbound_isatt = $worksheet->getCell("N".$i)->getCalculatedValue();								$material_inbound_isatt = new DateTime("1899-12-30 + $material_inbound_isatt days");								$material_inbound_isat = $material_inbound_isatt->format('Y-m-d');																$atf_approved2t = $worksheet->getCell("O".$i)->getCalculatedValue();								$atf_approved2t = new DateTime("1899-12-30 + $atf_approved2t days");								$atf_approved2 = $atf_approved2t->format('Y-m-d');																$atf_closedt = $worksheet->getCell("P".$i)->getCalculatedValue();								$atf_closedt = new DateTime("1899-12-30 + $atf_closedt days");								$atf_closed = $atf_closedt->format('Y-m-d');																$arrayinsertbenar =  array(									'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_tracker_siteinfo_id' => $ceksiteinfo['id'],									'atf_submit' => $atf_submit,									'atf_approved1' => $atf_approved1,									'dismantle' => $dismantle,									'material_pickup' => $material_pickup,									'material_inbound_nokia' => $material_inbound_nokia,									'material_inbound_isat' => $material_inbound_isat,									'atf_approved2' => $atf_approved2,									'atf_closed' => $atf_closed,									'status' => 1,									'file_name' => $filen,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),								);								//$this->db->update('tbl_master_tracker_siteprogress', $arraysiteprogress, array('boqno'=>$worksheet->getCell("B".$i)->getCalculatedValue()) );								array_push($array_benar, $arrayinsertbenar);							}else{								$statusdata = false;								$arraysiteinfosalah['id'] = $worksheet->getCell("A".$i)->getCalculatedValue();								$arraysiteinfosalah['boqno'] = $worksheet->getCell("B".$i)->getCalculatedValue();							}														if($statusdata == false){								$arrayinsertsalah = array(									'row' => $i,									'siteinfo' => $arraysiteinfosalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if($array_benar){						foreach($array_benar as $k => $v){							$this->db->update('tbl_master_tracker_atf', $array_benar[$k], array('boqno'=>$v['boqno']) );						}												$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					$insertbatchstatus = false;				break;				case "sitebinder":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arraysiteinfosalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arraysiteinfo = array(								'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arraysiteinfo)->row_array();							if(isset($ceksiteinfo)){								$doc_submitt = $worksheet->getCell("AC".$i)->getCalculatedValue();								$doc_submitt = new DateTime("1899-12-30 + $doc_submitt days");								$doc_submit = $doc_submitt->format('Y-m-d');																$doc_acceptt = $worksheet->getCell("AE".$i)->getCalculatedValue();								$doc_acceptt = new DateTime("1899-12-30 + $doc_acceptt days");								$doc_accept = $doc_acceptt->format('Y-m-d');																$mcr_exit_acceptt = $worksheet->getCell("AM".$i)->getCalculatedValue();								$mcr_exit_acceptt = new DateTime("1899-12-30 + $mcr_exit_acceptt days");								$mcr_exit_accept = $mcr_exit_acceptt->format('Y-m-d');																$endorse_submitt = $worksheet->getCell("AN".$i)->getCalculatedValue();								$endorse_submitt = new DateTime("1899-12-30 + $endorse_submitt days");								$endorse_submit = $endorse_submitt->format('Y-m-d');																$endorse_approvedt = $worksheet->getCell("AP".$i)->getCalculatedValue();								$endorse_approvedt = new DateTime("1899-12-30 + $endorse_approvedt days");								$endorse_approved = $endorse_approvedt->format('Y-m-d');																$dc_submitt = $worksheet->getCell("AR".$i)->getCalculatedValue();								$dc_submitt = new DateTime("1899-12-30 + $dc_submitt days");								$dc_submit = $dc_submitt->format('Y-m-d');								$dc_approvedt = $worksheet->getCell("AT".$i)->getCalculatedValue();								$dc_approvedt = new DateTime("1899-12-30 + $dc_approvedt days");								$dc_approved = $dc_approvedt->format('Y-m-d');																$arrayinsertbenar =  array(									'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_tracker_siteinfo_id' => $ceksiteinfo['id'],									'10_lld_ndb' => $worksheet->getCell("P".$i)->getCalculatedValue(),									'22_tssr_pdf' => $worksheet->getCell("Q".$i)->getCalculatedValue(),									'23_sid_pdf' => $worksheet->getCell("R".$i)->getCalculatedValue(),									'50_boq_pdf' => $worksheet->getCell("S".$i)->getCalculatedValue(),									'56_atf_xls' => $worksheet->getCell("T".$i)->getCalculatedValue(),									'56_atf_pdf' => $worksheet->getCell("U".$i)->getCalculatedValue(),									'57_atp_functional' => $worksheet->getCell("V".$i)->getCalculatedValue(),									'57_atp_physical' => $worksheet->getCell("W".$i)->getCalculatedValue(),									'61_redline_pdf' => $worksheet->getCell("X".$i)->getCalculatedValue(),									'62_bd_dwg' => $worksheet->getCell("Y".$i)->getCalculatedValue(),									'63_abd_pdf' => $worksheet->getCell("Z".$i)->getCalculatedValue(),									'xx_others' => $worksheet->getCell("AA".$i)->getCalculatedValue(),									'xx_others2' => $worksheet->getCell("AB".$i)->getCalculatedValue(),									'doc_submit' => $doc_submit,									'reviewer' => $worksheet->getCell("AD".$i)->getCalculatedValue(),									'doc_accept' => $doc_accept,									'doc_status' => $worksheet->getCell("AF".$i)->getCalculatedValue(),									'70_ssv' => $worksheet->getCell("AG".$i)->getCalculatedValue(),									'71_rssi' => $worksheet->getCell("AH".$i)->getCalculatedValue(),									'73_pmr' => $worksheet->getCell("AI".$i)->getCalculatedValue(),									'74_alarm_log' => $worksheet->getCell("AJ".$i)->getCalculatedValue(),									'xx_others3' => $worksheet->getCell("AK".$i)->getCalculatedValue(),									'xx_others4' => $worksheet->getCell("AL".$i)->getCalculatedValue(),									'mcr_exit_accept' => $mcr_exit_accept,									'endorse_submit' => $endorse_submit,									'approver' => $worksheet->getCell("AO".$i)->getCalculatedValue(),									'endorse_approved' => $endorse_approved,									'endorse_status' => $worksheet->getCell("AQ".$i)->getCalculatedValue(),									'dc_submit' => $dc_submit,									'dc_reviewer' => $worksheet->getCell("AS".$i)->getCalculatedValue(),									'dc_approved' => $dc_approved,									'dc_status' => $worksheet->getCell("AU".$i)->getCalculatedValue(),									'oa_to_atp' => $worksheet->getCell("AV".$i)->getCalculatedValue(),									'atp_to_submit' => $worksheet->getCell("AW".$i)->getCalculatedValue(),									'submit_to_accept' => $worksheet->getCell("AX".$i)->getCalculatedValue(),									'accept_to_endorse' => $worksheet->getCell("AY".$i)->getCalculatedValue(),									'endorse_to_dc_approved' => $worksheet->getCell("AZ".$i)->getCalculatedValue(),									'remarks' => $worksheet->getCell("BA".$i)->getCalculatedValue(),									'status' => 1,									'file_name' => $filen,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),								);								//$this->db->update('tbl_master_tracker_siteprogress', $arraysiteprogress, array('boqno'=>$worksheet->getCell("B".$i)->getCalculatedValue()) );								array_push($array_benar, $arrayinsertbenar);							}else{								$statusdata = false;								$arraysiteinfosalah['id'] = $worksheet->getCell("A".$i)->getCalculatedValue();								$arraysiteinfosalah['boqno'] = $worksheet->getCell("B".$i)->getCalculatedValue();							}														if($statusdata == false){								$arrayinsertsalah = array(									'row' => $i,									'siteinfo' => $arraysiteinfosalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if($array_benar){						foreach($array_benar as $k => $v){							$this->db->update('tbl_master_tracker_sitebinder', $array_benar[$k], array('boqno'=>$v['boqno']) );						}												$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					$insertbatchstatus = false;				break;				case "acceptanceclosing":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arraysiteinfosalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arraysiteinfo = array(								'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arraysiteinfo)->row_array();							if(isset($ceksiteinfo)){								$mcr_exit_datet = $worksheet->getCell("N".$i)->getCalculatedValue();								$mcr_exit_datet = new DateTime("1899-12-30 + $mcr_exit_datet days");								$mcr_exit_date = $mcr_exit_datet->format('Y-m-d');																$pac_datet = $worksheet->getCell("P".$i)->getCalculatedValue();								$pac_datet = new DateTime("1899-12-30 + $pac_datet days");								$pac_date = $pac_datet->format('Y-m-d');																$fac_datet = $worksheet->getCell("R".$i)->getCalculatedValue();								$fac_datet = new DateTime("1899-12-30 + $fac_datet days");								$fac_date = $fac_datet->format('Y-m-d');																$babt_submitt = $worksheet->getCell("X".$i)->getCalculatedValue();								$babt_submitt = new DateTime("1899-12-30 + $babt_submitt days");								$babt_submit = $babt_submitt->format('Y-m-d');																$babt_approvedt = $worksheet->getCell("Y".$i)->getCalculatedValue();								$babt_approvedt = new DateTime("1899-12-30 + $babt_approvedt days");								$babt_approved = $babt_approvedt->format('Y-m-d');																$baut1_datet = $worksheet->getCell("Z".$i)->getCalculatedValue();								$baut1_datet = new DateTime("1899-12-30 + $baut1_datet days");								$baut1_date = $baut1_datet->format('Y-m-d');								$bast1_datet = $worksheet->getCell("AB".$i)->getCalculatedValue();								$bast1_datet = new DateTime("1899-12-30 + $bast1_datet days");								$bast1_date = $bast1_datet->format('Y-m-d');								$baut2_datet = $worksheet->getCell("AC".$i)->getCalculatedValue();								$baut2_datet = new DateTime("1899-12-30 + $baut2_datet days");								$baut2_date = $baut2_datet->format('Y-m-d');																$bast2_datet = $worksheet->getCell("AE".$i)->getCalculatedValue();								$bast2_datet = new DateTime("1899-12-30 + $bast2_datet days");								$bast2_date = $bast2_datet->format('Y-m-d');																$baut3_datet = $worksheet->getCell("AF".$i)->getCalculatedValue();								$baut3_datet = new DateTime("1899-12-30 + $baut3_datet days");								$baut3_date = $baut3_datet->format('Y-m-d');																$bast3_datet = $worksheet->getCell("AH".$i)->getCalculatedValue();								$bast3_datet = new DateTime("1899-12-30 + $bast3_datet days");								$bast3_date = $bast3_datet->format('Y-m-d');																$invoice1_datet = $worksheet->getCell("AK".$i)->getCalculatedValue();								$invoice1_datet = new DateTime("1899-12-30 + $invoice1_datet days");								$invoice1_date = $invoice1_datet->format('Y-m-d');																$remittance1_datet = $worksheet->getCell("AM".$i)->getCalculatedValue();								$remittance1_datet = new DateTime("1899-12-30 + $remittance1_datet days");								$remittance1_date = $remittance1_datet->format('Y-m-d');								$invoice2_datet = $worksheet->getCell("AN".$i)->getCalculatedValue();								$invoice2_datet = new DateTime("1899-12-30 + $invoice2_datet days");								$invoice2_date = $invoice2_datet->format('Y-m-d');								$remittance2_datet = $worksheet->getCell("AP".$i)->getCalculatedValue();								$remittance2_datet = new DateTime("1899-12-30 + $remittance2_datet days");								$remittance2_date = $remittance2_datet->format('Y-m-d');																$invoice3_datet = $worksheet->getCell("AQ".$i)->getCalculatedValue();								$invoice3_datet = new DateTime("1899-12-30 + $invoice3_datet days");								$invoice3_date = $invoice3_datet->format('Y-m-d');								$remittance3_datet = $worksheet->getCell("AS".$i)->getCalculatedValue();								$remittance3_datet = new DateTime("1899-12-30 + $remittance3_datet days");								$remittance3_date = $remittance3_datet->format('Y-m-d');																$arrayinsertbenar =  array(									'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_tracker_siteinfo_id' => $ceksiteinfo['id'],									'mcr_exit_date' => $mcr_exit_date,									'mcr_exit_no' => $worksheet->getCell("O".$i)->getCalculatedValue(),									'pac_date' => $pac_date,									'pac_no' => $worksheet->getCell("Q".$i)->getCalculatedValue(),									'fac_date' => $fac_date,									'fac_no' => $worksheet->getCell("S".$i)->getCalculatedValue(),									'top_certificate' => $worksheet->getCell("T".$i)->getCalculatedValue(),									'remarks_certificate' => $worksheet->getCell("U".$i)->getCalculatedValue(),									'pmis_status' => $worksheet->getCell("V".$i)->getCalculatedValue(),									'pmp_status' => $worksheet->getCell("W".$i)->getCalculatedValue(),									'babt_submit' => $babt_submit,									'babt_approved' => $babt_approved,									'baut1_date' => $baut1_date,									'baut1_no' => $worksheet->getCell("AA".$i)->getCalculatedValue(),									'bast1_date' => $bast1_date,									'baut2_date' => $baut2_date,									'baut2_no' => $worksheet->getCell("AD".$i)->getCalculatedValue(),									'bast2_date' => $bast2_date,									'baut3_date' => $baut3_date,									'baut3_no' => $worksheet->getCell("AG".$i)->getCalculatedValue(),									'bast3_date' => $bast3_date,									'top_baut' => $worksheet->getCell("AI".$i)->getCalculatedValue(),									'remarks_baut' => $worksheet->getCell("AJ".$i)->getCalculatedValue(),									'invoice1_date' => $invoice1_date,									'invoice1_no' => $worksheet->getCell("AL".$i)->getCalculatedValue(),									'remittance1_date' => $remittance1_date,									'invoice2_date' => $invoice2_date,									'invoice2_no' => $worksheet->getCell("AO".$i)->getCalculatedValue(),									'remittance2_date' => $remittance2_date,									'invoice3_date' => $invoice3_date,									'invoice3_no' => $worksheet->getCell("AR".$i)->getCalculatedValue(),									'remittance3_date' => $remittance3_date,									'top_invoice' => $worksheet->getCell("AT".$i)->getCalculatedValue(),									'remarks_invoice' => $worksheet->getCell("AU".$i)->getCalculatedValue(),									'status' => 1,									'file_name' => $filen,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),								);								//$this->db->update('tbl_master_tracker_siteprogress', $arraysiteprogress, array('boqno'=>$worksheet->getCell("B".$i)->getCalculatedValue()) );								array_push($array_benar, $arrayinsertbenar);							}else{								$statusdata = false;								$arraysiteinfosalah['id'] = $worksheet->getCell("A".$i)->getCalculatedValue();								$arraysiteinfosalah['boqno'] = $worksheet->getCell("B".$i)->getCalculatedValue();							}														if($statusdata == false){								$arrayinsertsalah = array(									'row' => $i,									'siteinfo' => $arraysiteinfosalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if($array_benar){						foreach($array_benar as $k => $v){							$this->db->update('tbl_master_tracker_accclosing', $array_benar[$k], array('boqno'=>$v['boqno']) );						}												$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					$insertbatchstatus = false;				break;				case "costsales":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arraysiteinfosalah = array();						if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){							$arraysiteinfo = array(								'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),							);							$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arraysiteinfo)->row_array();							if(isset($ceksiteinfo)){																$arrayinsertbenar =  array(									'boqno' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_tracker_siteinfo_id' => $ceksiteinfo['id'],									'pac_baseline' => $worksheet->getCell("M".$i)->getCalculatedValue(),									'delay_no_onair' => $worksheet->getCell("O".$i)->getCalculatedValue(),									'delay_on_days' => $worksheet->getCell("P".$i)->getCalculatedValue(),									'delay_no_pac' => $worksheet->getCell("Q".$i)->getCalculatedValue(),									'delay_on_days2' => $worksheet->getCell("R".$i)->getCalculatedValue(),									'target_sales' => $worksheet->getCell("S".$i)->getCalculatedValue(),									'actual_sales' => $worksheet->getCell("T".$i)->getCalculatedValue(),									'target_cost' => $worksheet->getCell("U".$i)->getCalculatedValue(),									'actual_cost' => $worksheet->getCell("V".$i)->getCalculatedValue(),									'remarks' => $worksheet->getCell("W".$i)->getCalculatedValue(),									'file_name' => $filen,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),								);								//$this->db->update('tbl_master_tracker_siteprogress', $arraysiteprogress, array('boqno'=>$worksheet->getCell("B".$i)->getCalculatedValue()) );								array_push($array_benar, $arrayinsertbenar);							}else{								$statusdata = false;								$arraysiteinfosalah['id'] = $worksheet->getCell("A".$i)->getCalculatedValue();								$arraysiteinfosalah['boqno'] = $worksheet->getCell("B".$i)->getCalculatedValue();							}														if($statusdata == false){								$arrayinsertsalah = array(									'row' => $i,									'siteinfo' => $arraysiteinfosalah,								);								array_push($array_salah, $arrayinsertsalah);							}						}					}										if($array_benar){						foreach($array_benar as $k => $v){							$this->db->update('tbl_master_tracker_costsales', $array_benar[$k], array('boqno'=>$v['boqno']) );						}												$arrayupload = array(							'type_tracker' => $type,							'file_name' => $filen,							'type_upload' => $method,							'remark' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s')						);						$this->db->insert('tbl_uploader_tracker', $arrayupload);					}					$insertbatchstatus = false;				break;				case "received":					$boquery = true;					$boqaseli = 1;					$arrayboq = array();					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arrayphasesalah = array();						$arraypotypesalah = array();						$arrayponosalah = array();						$arraycrnosalah = array();						if($worksheet->getCell("E".$i)->getCalculatedValue() != ""){							$arrayphase = array(								'phase_code' => $worksheet->getCell("E".$i)->getCalculatedValue(),							);							$cekphase = $this->db->get_where('tbl_master_phase', $arrayphase)->row_array();							if(isset($cekphase)){								$tbl_master_phase_id = $cekphase['id'];							}else{								$statusdata = false;								$arrayphasesalah['phase_code'] = $worksheet->getCell("E".$i)->getCalculatedValue();								$arrayphasesalah['phase_name'] = $worksheet->getCell("F".$i)->getCalculatedValue();								$arrayphasesalah['phase_year'] = $worksheet->getCell("G".$i)->getCalculatedValue();							}						}						if($worksheet->getCell("H".$i)->getCalculatedValue() != ""){								$arraypotype = array(									'po_type' => $worksheet->getCell("H".$i)->getCalculatedValue(),								);								$cekpotype = $this->db->get_where('tbl_master_potype', $arraypotype)->row_array();								if(isset($cekpotype)){									$tbl_master_potype_id = $cekpotype['id'];								}else{									$statusdata = false;									$arraypotypesalah['po_type'] = $worksheet->getCell("H".$i)->getCalculatedValue();								}						}						if($worksheet->getCell("K".$i)->getCalculatedValue() != ""){								$arraypono = array(									'po_no' => $worksheet->getCell("K".$i)->getCalculatedValue(),								);								$cekpono = $this->db->get_where('tbl_master_po', $arraypono)->row_array();								if(isset($cekpono)){									$tbl_master_po_id = $cekpono['id'];								}else{									$statusdata = false;									$arrayponosalah['po_no'] = $worksheet->getCell("K".$i)->getCalculatedValue();								}						}						if($worksheet->getCell("BR".$i)->getCalculatedValue() != ""){								$arraycrno = array(									'cr_no_nokia' => $worksheet->getCell("BR".$i)->getCalculatedValue(),								);								$cekcrno = $this->db->get_where('tbl_master_cr', $arraycrno)->row_array();								if(isset($cekcrno)){									$tbl_master_cr_id = $cekcrno['id'];								}else{									$statusdata = false;									$arraycrnosalah['cr_no_nokia'] = $worksheet->getCell("BR".$i)->getCalculatedValue();								}						}													if($statusdata == true){								if($method == 'N'){									if($boquery == true){										$sqlboq = "											SELECT MAX(id) as boq_max											FROM tbl_all_database																					";																				$queryboq = $this->db->query($sqlboq)->row_array();										if($queryboq['boq_max'] != null){											$boqno = ($queryboq['boq_max'] + 1);												$boqaseli = ($queryboq['boq_max'] + 1);										}else{											$boqaseli = 1;											}										$boquery = false;									}else{										$boqaseli = ($boqaseli + 1);											$boquery = false;									}							$arrayinsertbenar = array(								'id_reff1' => $boqaseli,								'tbl_master_phase_id' => $tbl_master_phase_id,								'tbl_master_potype_id' => $tbl_master_potype_id,								'tbl_master_po_id' => $tbl_master_po_id,								'tbl_master_cr_id' => $tbl_master_cr_id,								'level' => 1,								'pr_number' => $worksheet->getCell("I".$i)->getCalculatedValue(),								'pr_line_item' => $worksheet->getCell("J".$i)->getCalculatedValue(),								'purchasing_group' => $worksheet->getCell("M".$i)->getCalculatedValue(),								'document_type' => $worksheet->getCell("N".$i)->getCalculatedValue(),								'vendor_account_number' => $worksheet->getCell("O".$i)->getCalculatedValue(),								'contact_person' => $worksheet->getCell("P".$i)->getCalculatedValue(),								'term_of_payment' => $worksheet->getCell("Q".$i)->getCalculatedValue(),									'incoterms_code' => $worksheet->getCell("R".$i)->getCalculatedValue(),								'incoterms_location' => $worksheet->getCell("S".$i)->getCalculatedValue(),								'implementer' => $worksheet->getCell("U".$i)->getCalculatedValue(),								'manager' => $worksheet->getCell("V".$i)->getCalculatedValue(),								'document_text_free_text_notes' => $worksheet->getCell("W".$i)->getCalculatedValue(),								'collective_no' => $worksheet->getCell("X".$i)->getCalculatedValue(),								'discount_type_header' => $worksheet->getCell("Y".$i)->getCalculatedValue(),								'discount_amount_percentage_header' => $worksheet->getCell("Z".$i)->getCalculatedValue(),								'line_item' => $worksheet->getCell("AA".$i)->getCalculatedValue(),								'requester' => $worksheet->getCell("AB".$i)->getCalculatedValue(),								'rfx_auction_number' => $worksheet->getCell("AC".$i)->getCalculatedValue(),									'contract_number' => $worksheet->getCell("AD".$i)->getCalculatedValue(),								'account_assignment_category' => $worksheet->getCell("AE".$i)->getCalculatedValue(),								'item_category' => $worksheet->getCell("AF".$i)->getCalculatedValue(),								'tax_code' => $worksheet->getCell("AG".$i)->getCalculatedValue(),								'material_number' => $worksheet->getCell("AH".$i)->getCalculatedValue(),								'short_text' => $worksheet->getCell("AI".$i)->getCalculatedValue(),								'item_text' => $worksheet->getCell("AJ".$i)->getCalculatedValue(),								'limit' => $worksheet->getCell("AK".$i)->getCalculatedValue(),								'materials_quantity' => $worksheet->getCell("AL".$i)->getCalculatedValue(),								'material_price' => $worksheet->getCell("AM".$i)->getCalculatedValue(),								'material_group' => $worksheet->getCell("AN".$i)->getCalculatedValue(),									'plant' => $worksheet->getCell("AO".$i)->getCalculatedValue(),								'delivery_date' => $worksheet->getCell("AP".$i)->getCalculatedValue(),								'require_gr' => $worksheet->getCell("AQ".$i)->getCalculatedValue(),								'invoice_receipt' => $worksheet->getCell("AR".$i)->getCalculatedValue(),								'discount_type_item' => $worksheet->getCell("AS".$i)->getCalculatedValue(),								'amount_percentage_item' => $worksheet->getCell("AT".$i)->getCalculatedValue(),								'indicator' => $worksheet->getCell("AU".$i)->getCalculatedValue(),								'assigned_to_line_item' => $worksheet->getCell("AV".$i)->getCalculatedValue(),								'service_number' => $worksheet->getCell("AW".$i)->getCalculatedValue(),								'services_quantity' => $worksheet->getCell("AX".$i)->getCalculatedValue(),								'gross_price' => $worksheet->getCell("AY".$i)->getCalculatedValue(),									'gl_account_number' => $worksheet->getCell("AZ".$i)->getCalculatedValue(),								'business_area' => $worksheet->getCell("BA".$i)->getCalculatedValue(),								'cost_center' => $worksheet->getCell("BB".$i)->getCalculatedValue(),								'wbs' => $worksheet->getCell("BC".$i)->getCalculatedValue(),								'internal_order' => $worksheet->getCell("BD".$i)->getCalculatedValue(),								'assets_number' => $worksheet->getCell("BE".$i)->getCalculatedValue(),								'network_number' => $worksheet->getCell("BF".$i)->getCalculatedValue(),								'activity_number' => $worksheet->getCell("BG".$i)->getCalculatedValue(),								'assigned_to_line_item2' => $worksheet->getCell("BH".$i)->getCalculatedValue(),								'invoicing_plan_date' => $worksheet->getCell("BI".$i)->getCalculatedValue(),								'percentage_to_be_invoiced' => $worksheet->getCell("BJ".$i)->getCalculatedValue(),								'values_to_be_invoiced' => $worksheet->getCell("BK".$i)->getCalculatedValue(),								'buyer' => $worksheet->getCell("BL".$i)->getCalculatedValue(),								'actual_qty' => $worksheet->getCell("BN".$i)->getCalculatedValue(),									'delta_qty' => $worksheet->getCell("BO".$i)->getCalculatedValue(),								'status_cr_qty' => $worksheet->getCell("BP".$i)->getCalculatedValue(),								'remarkscr' => $worksheet->getCell("BQ".$i)->getCalculatedValue(),								'material_gross_price' => $worksheet->getCell("BT".$i)->getCalculatedValue(),								'material_nett_price' => $worksheet->getCell("BU".$i)->getCalculatedValue(),								'total_gross_price' => $worksheet->getCell("BV".$i)->getCalculatedValue(),								'total_nett_price' => $worksheet->getCell("BW".$i)->getCalculatedValue(),								'total_net_actual' => $worksheet->getCell("BX".$i)->getCalculatedValue(),								'total_net_delta' => $worksheet->getCell("BY".$i)->getCalculatedValue(),										'file_name' => $filen,								'update_by' => $this->auth['nama_user'],								'update_date' => date('Y-m-d H:i:s'),								'status' => 1							);														if($method == 'N'){								array_push($array_benar, $arrayinsertbenar);							}elseif($method == 'U'){								$id = $worksheet->getCell("A".$i)->getCalculatedValue();								if($id){									$this->db->update('tbl_all_database', $arrayinsertbenar, array('id'=>$id) );								} 							}						}else{							$arrayinsertsalah = array(								'row' => $i,								'phase' => $arrayphasesalah,								'potype' => $arraypotypesalah,								'masterpo' => $arrayponosalah,								'mastercr' => $arraycrnosalah,							);							array_push($array_salah, $arrayinsertsalah);						}					}				}					if(empty($array_salah)){						$arrayupload = array(							'file_name' => $filen,							'type_upload' => $method,							'remarks' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s'),							'status' => 1						);						$this->db->insert('tbl_uploader_alldatabase', $arrayupload);					}					if($method == 'U'){						if($statusdata == true) echo $statusdata;exit;					}										$table = "tbl_all_database";									break;				case "reservation":					for($i=6; $i <= $worksheet->getHighestRow(); $i++){						$statusdata = true;						$arrayreservationsalah = array();												if($worksheet->getCell("B".$i)->getCalculatedValue() != ""){								$arrayrcv = array(								"id" => $worksheet->getCell("B".$i)->getCalculatedValue()							);							$cekreceived = $this->db->get_where('tbl_all_database', $arrayrcv)->row_array();							if($worksheet->getCell("BZ".$i)->getCalculatedValue() != ""){									$arrayboq = array(									"boqno" => $worksheet->getCell("BZ".$i)->getCalculatedValue()								);								$ceksiteinfo = $this->db->get_where('tbl_master_tracker_siteinfo', $arrayboq)->row_array();								$siteinfo = $ceksiteinfo['id'];							}else{								$siteinfo = null;							}													if(isset($cekreceived)){								$arrayinsertbenar = array(									'id_reff1' => $worksheet->getCell("B".$i)->getCalculatedValue(),									'tbl_master_phase_id' => $cekreceived['tbl_master_phase_id'],									'tbl_master_potype_id' => $cekreceived['tbl_master_potype_id'],									'tbl_master_po_id' => $cekreceived['tbl_master_po_id'],									'tbl_master_cr_id' => $cekreceived['tbl_master_cr_id'],									'level' => 2,									'tbl_master_tracker_siteinfo_id' => $siteinfo,									'pr_number' => $worksheet->getCell("I".$i)->getCalculatedValue(),									'pr_line_item' => $cekreceived['pr_line_item'],									'purchasing_group' => $cekreceived['purchasing_group'],									'document_type' => $cekreceived['document_type'],									'vendor_account_number' => $cekreceived['vendor_account_number'],									'contact_person' => $cekreceived['contact_person'],									'term_of_payment' => $cekreceived['term_of_payment'],									'incoterms_code' => $cekreceived['incoterms_code'],									'incoterms_location' => $cekreceived['incoterms_code'],									'implementer' => $cekreceived['implementer'],									'manager' => $cekreceived['manager'],									'document_text_free_text_notes' => $cekreceived['document_text_free_text_notes'],									'collective_no' => $cekreceived['collective_no'],									'discount_type_header' => $cekreceived['discount_type_header'],									'discount_amount_percentage_header' => $cekreceived['discount_amount_percentage_header'],									'line_item' => $cekreceived['line_item'],									'requester' => $cekreceived['requester'],									'rfx_auction_number' => $cekreceived['rfx_auction_number'],										'contract_number' => $cekreceived['contract_number'],										'account_assignment_category' => $cekreceived['account_assignment_category'],										'item_category' => $cekreceived['item_category'],										'tax_code' => $cekreceived['tax_code'],										'material_number' => $cekreceived['material_number'],										'short_text' => $cekreceived['short_text'],									'item_text' => $cekreceived['item_text'],									'limit' => $cekreceived['limit'],									'materials_quantity' => $cekreceived['materials_quantity'],									'material_price' => $cekreceived['material_price'],									'material_group' => $cekreceived['material_group'],									'plant' => $cekreceived['plant'],									'delivery_date' => $cekreceived['delivery_date'],									'require_gr' => $cekreceived['require_gr'],									'invoice_receipt' => $cekreceived['invoice_receipt'],									'discount_type_item' => $cekreceived['discount_type_item'],									'amount_percentage_item' => $cekreceived['amount_percentage_item'],									'indicator' => $cekreceived['indicator'],									'assigned_to_line_item' => $cekreceived['assigned_to_line_item'],									'service_number' => $cekreceived['service_number'],									'services_quantity' => $cekreceived['services_quantity'],									'gross_price' => $cekreceived['gross_price'],										'gl_account_number' => $cekreceived['gl_account_number'],										'business_area' => $cekreceived['business_area'],										'cost_center' => $cekreceived['cost_center'],										'wbs' => $cekreceived['wbs'],									'internal_order' => $cekreceived['internal_order'],									'assets_number' => $cekreceived['assets_number'],									'network_number' => $cekreceived['network_number'],									'activity_number' => $cekreceived['activity_number'],									'assigned_to_line_item2' => $cekreceived['assigned_to_line_item2'],									'invoicing_plan_date' => $cekreceived['invoicing_plan_date'],									'percentage_to_be_invoiced' => $cekreceived['percentage_to_be_invoiced'],									'values_to_be_invoiced' => $cekreceived['values_to_be_invoiced'],									'buyer' => $cekreceived['buyer'],									'actual_qty' => $cekreceived['actual_qty'],									'delta_qty' => $cekreceived['delta_qty'],									'status_cr_qty' => $cekreceived['status_cr_qty'],									'remarkscr' => $cekreceived['remarkscr'],									'material_gross_price' => $cekreceived['material_gross_price'],									'material_nett_price' => $cekreceived['material_nett_price'],									'total_gross_price' => $cekreceived['total_gross_price'],									'total_nett_price' => $cekreceived['total_nett_price'],									'total_net_actual' => $cekreceived['total_net_actual'],									'total_net_delta' => $cekreceived['total_net_delta'],									'plan_qty_mapping' => $worksheet->getCell("CF".$i)->getCalculatedValue(),									'aqtual_qty_mapping' => $worksheet->getCell("CG".$i)->getCalculatedValue(),									'delta_qty_mapping' => $worksheet->getCell("CH".$i)->getCalculatedValue(),									'status_cr_qty_mapping' => $worksheet->getCell("CI".$i)->getCalculatedValue(),									'status_cr_reloc_mapping' => $worksheet->getCell("CJ".$i)->getCalculatedValue(),									'remarks_cr_mapping' => $worksheet->getCell("CK".$i)->getCalculatedValue(),									'remarks_cr_reloc_mapping' => $worksheet->getCell("CL".$i)->getCalculatedValue(),									'total_gross_price_mapping' => $worksheet->getCell("CM".$i)->getCalculatedValue(),									'total_nett_price_mapping' => $worksheet->getCell("CN".$i)->getCalculatedValue(),									'total_nett_actual_mapping' => $worksheet->getCell("CO".$i)->getCalculatedValue(),									'total_net_delta_mapping' => $worksheet->getCell("CP".$i)->getCalculatedValue(),											'file_name' => $filen,									'update_by' => $this->auth['nama_user'],									'update_date' => date('Y-m-d H:i:s'),									'status' => 1								);																if($method == 'N'){									array_push($array_benar, $arrayinsertbenar);								}elseif($method == 'U'){									$id = $worksheet->getCell("A".$i)->getCalculatedValue();									if($id){										$this->db->update('tbl_all_database', $arrayinsertbenar, array('id'=>$id) );									} 								}															}else{								$arrayinsertsalah = array(									'row' => $i,									'id_received' => $worksheet->getCell("B".$i)->getCalculatedValue(),								);								array_push($array_salah, $arrayinsertsalah);															}													}												/* Backup Koding Bree												if($worksheet->getCell("E".$i)->getCalculatedValue() != ""){							$arrayphase = array(								'phase_code' => $worksheet->getCell("E".$i)->getCalculatedValue(),							);							$cekphase = $this->db->get_where('tbl_master_phase', $arrayphase)->row_array();							if(isset($cekphase)){								$tbl_master_phase_id = $cekphase['id'];							}else{								$statusdata = false;								$arrayphasesalah['phase_code'] = $worksheet->getCell("E".$i)->getCalculatedValue();								$arrayphasesalah['phase_name'] = $worksheet->getCell("F".$i)->getCalculatedValue();								$arrayphasesalah['phase_year'] = $worksheet->getCell("G".$i)->getCalculatedValue();							}						}						if($worksheet->getCell("H".$i)->getCalculatedValue() != ""){								$arraypotype = array(									'po_type' => $worksheet->getCell("H".$i)->getCalculatedValue(),								);								$cekpotype = $this->db->get_where('tbl_master_potype', $arraypotype)->row_array();								if(isset($cekpotype)){									$tbl_master_potype_id = $cekpotype['id'];								}else{									$statusdata = false;									$arraypotypesalah['po_type'] = $worksheet->getCell("H".$i)->getCalculatedValue();								}						}						if($worksheet->getCell("K".$i)->getCalculatedValue() != ""){								$arraypono = array(									'po_no' => $worksheet->getCell("K".$i)->getCalculatedValue(),								);								$cekpono = $this->db->get_where('tbl_master_po', $arraypono)->row_array();								if(isset($cekpono)){									$tbl_master_po_id = $cekpono['id'];								}else{									$statusdata = false;									$arrayponosalah['po_no'] = $worksheet->getCell("K".$i)->getCalculatedValue();								}						}						if($worksheet->getCell("BR".$i)->getCalculatedValue() != ""){								$arraycrno = array(									'cr_no_nokia' => $worksheet->getCell("BR".$i)->getCalculatedValue(),								);								$cekcrno = $this->db->get_where('tbl_master_cr', $arraycrno)->row_array();								if(isset($cekcrno)){									$tbl_master_cr_id = $cekcrno['id'];								}else{									$statusdata = false;									$arraycrnosalah['cr_no_nokia'] = $worksheet->getCell("BR".$i)->getCalculatedValue();								}						}													if($statusdata == true){							$arrayinsertbenar = array(								'tbl_master_phase_id' => $tbl_master_phase_id,								'tbl_master_potype_id' => $tbl_master_potype_id,								'tbl_master_po_id' => $tbl_master_po_id,								'tbl_master_tracker_siteinfo_id' => $tbl_master_tracker_siteinfo_id,								'pr_number' => $worksheet->getCell("I".$i)->getCalculatedValue(),								'pr_line_item' => $worksheet->getCell("J".$i)->getCalculatedValue(),								'purchasing_group' => $worksheet->getCell("M".$i)->getCalculatedValue(),								'document_type' => $worksheet->getCell("N".$i)->getCalculatedValue(),								'vendor_account_number' => $worksheet->getCell("O".$i)->getCalculatedValue(),								'contact_person' => $worksheet->getCell("P".$i)->getCalculatedValue(),								'term_of_payment' => $worksheet->getCell("Q".$i)->getCalculatedValue(),									'incoterms_code' => $worksheet->getCell("R".$i)->getCalculatedValue(),								'incoterms_location' => $worksheet->getCell("S".$i)->getCalculatedValue(),								'implementer' => $worksheet->getCell("U".$i)->getCalculatedValue(),								'manager' => $worksheet->getCell("V".$i)->getCalculatedValue(),								'document_text_free_text_notes' => $worksheet->getCell("W".$i)->getCalculatedValue(),								'collective_no' => $worksheet->getCell("X".$i)->getCalculatedValue(),								'discount_type_header' => $worksheet->getCell("Y".$i)->getCalculatedValue(),								'discount_amount_percentage_header' => $worksheet->getCell("Z".$i)->getCalculatedValue(),								'line_item' => $worksheet->getCell("AA".$i)->getCalculatedValue(),								'requester' => $worksheet->getCell("AB".$i)->getCalculatedValue(),								'rfx_auction_number' => $worksheet->getCell("AC".$i)->getCalculatedValue(),									'contract_number' => $worksheet->getCell("AD".$i)->getCalculatedValue(),								'account_assignment_category' => $worksheet->getCell("AE".$i)->getCalculatedValue(),								'item_category' => $worksheet->getCell("AF".$i)->getCalculatedValue(),								'tax_code' => $worksheet->getCell("AG".$i)->getCalculatedValue(),								'material_number' => $worksheet->getCell("AH".$i)->getCalculatedValue(),								'short_text' => $worksheet->getCell("AI".$i)->getCalculatedValue(),								'item_text' => $worksheet->getCell("AJ".$i)->getCalculatedValue(),								'limit' => $worksheet->getCell("AK".$i)->getCalculatedValue(),								'materials_quantity' => $worksheet->getCell("AL".$i)->getCalculatedValue(),								'material_price' => $worksheet->getCell("AM".$i)->getCalculatedValue(),								'material_group' => $worksheet->getCell("AN".$i)->getCalculatedValue(),									'plant' => $worksheet->getCell("AO".$i)->getCalculatedValue(),								'delivery_date' => $worksheet->getCell("AP".$i)->getCalculatedValue(),								'require_gr' => $worksheet->getCell("AQ".$i)->getCalculatedValue(),								'invoice_receipt' => $worksheet->getCell("AR".$i)->getCalculatedValue(),								'discount_type_item' => $worksheet->getCell("AS".$i)->getCalculatedValue(),								'amount_percentage_item' => $worksheet->getCell("AT".$i)->getCalculatedValue(),								'indicator' => $worksheet->getCell("AU".$i)->getCalculatedValue(),								'assigned_to_line_item' => $worksheet->getCell("AV".$i)->getCalculatedValue(),								'service_number' => $worksheet->getCell("AW".$i)->getCalculatedValue(),								'services_quantity' => $worksheet->getCell("AX".$i)->getCalculatedValue(),								'gross_price' => $worksheet->getCell("AY".$i)->getCalculatedValue(),									'gl_account_number' => $worksheet->getCell("AZ".$i)->getCalculatedValue(),								'business_area' => $worksheet->getCell("BA".$i)->getCalculatedValue(),								'cost_center' => $worksheet->getCell("BB".$i)->getCalculatedValue(),								'wbs' => $worksheet->getCell("BC".$i)->getCalculatedValue(),								'internal_order' => $worksheet->getCell("BD".$i)->getCalculatedValue(),								'assets_number' => $worksheet->getCell("BE".$i)->getCalculatedValue(),								'network_number' => $worksheet->getCell("BF".$i)->getCalculatedValue(),								'activity_number' => $worksheet->getCell("BG".$i)->getCalculatedValue(),								'assigned_to_line_item2' => $worksheet->getCell("BH".$i)->getCalculatedValue(),								'invoicing_plan_date' => $worksheet->getCell("BI".$i)->getCalculatedValue(),								'percentage_to_be_invoiced' => $worksheet->getCell("BJ".$i)->getCalculatedValue(),								'values_to_be_invoiced' => $worksheet->getCell("BK".$i)->getCalculatedValue(),								'buyer' => $worksheet->getCell("BL".$i)->getCalculatedValue(),								'actual_qty' => $worksheet->getCell("BN".$i)->getCalculatedValue(),									'delta_qty' => $worksheet->getCell("BO".$i)->getCalculatedValue(),								'status_cr_qty' => $worksheet->getCell("BP".$i)->getCalculatedValue(),								'remarkscr' => $worksheet->getCell("BQ".$i)->getCalculatedValue(),								'material_gross_price' => $worksheet->getCell("BT".$i)->getCalculatedValue(),								'material_nett_price' => $worksheet->getCell("BU".$i)->getCalculatedValue(),								'total_gross_price' => $worksheet->getCell("BV".$i)->getCalculatedValue(),								'total_nett_price' => $worksheet->getCell("BW".$i)->getCalculatedValue(),								'total_net_actual' => $worksheet->getCell("BX".$i)->getCalculatedValue(),								'total_net_delta' => $worksheet->getCell("BY".$i)->getCalculatedValue(),								'plan_qty_mapping' => $worksheet->getCell("CF".$i)->getCalculatedValue(),								'aqtual_qty_mapping' => $worksheet->getCell("CG".$i)->getCalculatedValue(),								'delta_qty_mapping' => $worksheet->getCell("CH".$i)->getCalculatedValue(),								'status_cr_qty_mapping' => $worksheet->getCell("CI".$i)->getCalculatedValue(),								'status_cr_reloc_mapping' => $worksheet->getCell("CJ".$i)->getCalculatedValue(),								'remarks_cr_mapping' => $worksheet->getCell("CK".$i)->getCalculatedValue(),								'remarks_cr_reloc_mapping' => $worksheet->getCell("CL".$i)->getCalculatedValue(),								'total_gross_price_mapping' => $worksheet->getCell("CM".$i)->getCalculatedValue(),								'total_nett_price_mapping' => $worksheet->getCell("CN".$i)->getCalculatedValue(),								'total_nett_actual_mapping' => $worksheet->getCell("CO".$i)->getCalculatedValue(),								'total_net_delta_mapping' => $worksheet->getCell("CP".$i)->getCalculatedValue(),										'file_name' => $filen,								'update_by' => $this->auth['nama_user'],								'update_date' => date('Y-m-d H:i:s'),								'status' => 1							);														if($method == 'N'){								array_push($array_benar, $arrayinsertbenar);							}elseif($method == 'U'){								$id = $worksheet->getCell("A".$i)->getCalculatedValue();								if($id){									$this->db->update('tbl_all_database', $arrayinsertbenar, array('id'=>$id) );								} 							}						}else{							$arrayinsertsalah = array(								'row' => $i,								'phase' => $arrayphasesalah,								'potype' => $arraypotypesalah,								'masterpo' => $arrayponosalah,								'mastercr' => $arraycrnosalah,							);							array_push($array_salah, $arrayinsertsalah);						}												End Backup Koding Bree */											}					if(empty($array_salah)){						$arrayupload = array(							'file_name' => $filen,							'type_upload' => $method,							'remarks' => $this->input->post('remark'),							'update_by' => $this->auth['nama_user'],							'update_date' => date('Y-m-d H:i:s'),							'status' => 1						);						$this->db->insert('tbl_uploader_alldatabase', $arrayupload);					}					if($method == 'U'){						if($statusdata == true) echo $statusdata;exit;					}										$table = "tbl_all_database";									break;			}						//echo count($array_salah);exit;			//echo "<pre>";			//print_r($array_salah);exit;				if(count($array_salah) != 0){					return $array_salah;					//exit;				}else{					if($array_benar){						if($insertbatchstatus == true){								$this->db->insert_batch($table, $array_benar);						}						return 1;					}else{						return 0;					}				}						/*			if($this->db->trans_status() == false){				$this->db->trans_rollback();				return 0;			}else{				return $this->db->trans_commit();			}			*/					}			}	}